<!doctype html>



  


<html class="theme-next pisces use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  
    
      
    

    
  

  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Lobster Two:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="你陪着我的时候，我从没有羡慕任何人。">
<meta property="og:type" content="website">
<meta property="og:title" content="chesian">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="chesian">
<meta property="og:description" content="你陪着我的时候，我从没有羡慕任何人。">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="chesian">
<meta name="twitter:description" content="你陪着我的时候，我从没有羡慕任何人。">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>

  <title> chesian </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  



  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?e3bc6c75aa4aaaa95ce188f16a662898";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>








  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">chesian</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="#" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup">
 <span class="search-icon fa fa-search"></span>
 <input type="text" id="local-search-input">
 <div id="local-search-result"></div>
 <span class="popup-btn-close">close</span>
</div>


    </div>
  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/02/22/aliyun-svn/" itemprop="url">
                  阿里云服务器安装svn服务器端
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-02-22T23:07:59+08:00" content="2017 年 02 月 22 日">
              2017 年 02 月 22 日
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/开发工具/" itemprop="url" rel="index">
                    <span itemprop="name">开发工具</span>
                  </a>
                </span>

                
                
                  ， 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/开发工具/SVN/" itemprop="url" rel="index">
                    <span itemprop="name">SVN</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2017/02/22/aliyun-svn/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/02/22/aliyun-svn/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2017/02/22/aliyun-svn/" class="leancloud_visitors" data-flag-title="阿里云服务器安装svn服务器端">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="1-安装svn服务器端"><a href="#1-安装svn服务器端" class="headerlink" title="1.安装svn服务器端"></a>1.安装svn服务器端</h4><pre><code>yum install subversion      
</code></pre><p>从镜像下载安装svn服务器端<br>中间会提示是否ok，输入y，确认<br>安装成功提示：…..complete！</p>
<p>依次执行如下命令：</p>
<pre><code>cd /usr/local/              //进入目录，准备创建svn目录
mkdir svnRepo                   //创建一个svn目录
chmod -R 777 svnRepo            //修改目录权限为777
svnadmin create /usr/local/svnRepo/first  //创建一个svn版本仓库first(first可以随便起名字)
</code></pre><p>cd first/conf               //进入first版本仓库下的配置文件目录</p>
<h4 id="2-下面要修改这个目录下的三个配置文件"><a href="#2-下面要修改这个目录下的三个配置文件" class="headerlink" title="2.下面要修改这个目录下的三个配置文件"></a>2.下面要修改这个目录下的三个配置文件</h4><p>(1)vi svnserve.conf    //配置版本库信息和用户文件和用户密码文件的路径、版本库路径<br>把</p>
<pre><code># anon-access = read
# auth-access = write
# password-db = passwd
</code></pre><p>//这四行，前面的#号和空格去掉，变成</p>
<pre><code>anon-access = none      //改成none
auth-access = write
password-db = passwd

realm = first           //改成自己的版本库
</code></pre><p>保存退出</p>
<p>(2)vi authz     //文件,创建svn组和组用户的权限</p>
<pre><code>[groups]
first = ddl,shl //创建一个first的组，并制定两个用户ddl和shl
[/]             //制定根目录下的权限
@first = rw     //first组用户权限为读写
* = r           //其他用户只有读权限
</code></pre><p>保存退出</p>
<p>(3) vi passwd   //创建或修改用户密码</p>
<pre><code>[users]
ddl = 123456    //用户名为gep的用户的密码为123456
shl = 123456    //。。。
</code></pre><p>保存退出</p>
<h4 id="3-然后要设置自启动"><a href="#3-然后要设置自启动" class="headerlink" title="3.然后要设置自启动"></a>3.然后要设置自启动</h4><pre><code>vi /etc/rc.local    
</code></pre><p>打开自启动文件<br>文件内容如下</p>
<pre><code>#!/bin/sh
# This script will be executed *after* all the other init scripts.
# You can put your own initialization stuff in here if you don&apos;t
# want to do the full Sys V style init stuff.

touch /var/lock/subsys/local
</code></pre><p>添加下面一行</p>
<pre><code>svnserve -d -r /usr/local/svnRepo/first
</code></pre><p>保存退出</p>
<pre><code>ps aux |grep &apos;svn&apos;  查找所有svn启动的进程
</code></pre><p>杀死 然后启动svn</p>
<pre><code>svnserve -d -r /usr/local/svnRepo/first 启动svn(可以把这个放到/etc/local/rc.local文件中，实现开机自启动)
</code></pre><h4 id="4-限制不同的用户对不同的版本库操作权限，修改版本库中的conf目录下的-authz文件"><a href="#4-限制不同的用户对不同的版本库操作权限，修改版本库中的conf目录下的-authz文件" class="headerlink" title="4.限制不同的用户对不同的版本库操作权限，修改版本库中的conf目录下的 authz文件"></a>4.限制不同的用户对不同的版本库操作权限，修改版本库中的conf目录下的 authz文件</h4><p>以配置 first 版本库为例</p>
<pre><code>vi authz

[groups]
company = user1,user2
[first:/]             //指定版本库跟目录下的权限
@company = rw     //company组用户权限为读写
* = r           //其他用户只有读权限
</code></pre><p>保存退出</p>
<p>vi passwd 设置组中用户的账号和密码</p>
<pre><code>[users]
user1  = 123456
user2 = 123456
</code></pre><h4 id="5-客户端访问"><a href="#5-客户端访问" class="headerlink" title="5.客户端访问"></a>5.客户端访问</h4><p>假设客户端使用tortoiseSVN<br>打开资源库浏览器输入地址, svn://你的svn服务器ip:3690<br>输入用户名ddl 密码12345<br>因为没有网资源库里放文件所以需要你用客户端右键【create forder】，然后【add forder】</p>
<h4 id="6-SVN版本库起动方式，现在svnRepo下面有-first、test-两个版本库"><a href="#6-SVN版本库起动方式，现在svnRepo下面有-first、test-两个版本库" class="headerlink" title="6.SVN版本库起动方式，现在svnRepo下面有 first、test 两个版本库"></a>6.SVN版本库起动方式，现在svnRepo下面有 first、test 两个版本库</h4><p>1：单版本库起动 </p>
<pre><code>svnserve -d -r /usr/local/svnRepo/first
</code></pre><p>2：多版本库起动</p>
<pre><code>svnserve -d -r /usr/local/svnRepo
</code></pre><p>区别在于起动svn时候的命令中的启动参数-r指定的目录。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/02/22/svn-rule/" itemprop="url">
                  SVN提交更新的一些准则
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-02-22T23:00:31+08:00" content="2017 年 02 月 22 日">
              2017 年 02 月 22 日
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/开发工具/" itemprop="url" rel="index">
                    <span itemprop="name">开发工具</span>
                  </a>
                </span>

                
                
                  ， 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/开发工具/SVN/" itemprop="url" rel="index">
                    <span itemprop="name">SVN</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2017/02/22/svn-rule/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/02/22/svn-rule/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2017/02/22/svn-rule/" class="leancloud_visitors" data-flag-title="SVN提交更新的一些准则">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="SVN提交更新的一个准则"><a href="#SVN提交更新的一个准则" class="headerlink" title="SVN提交更新的一个准则"></a>SVN提交更新的一个准则</h3><h4 id="负责而谨慎地提交自己的代码"><a href="#负责而谨慎地提交自己的代码" class="headerlink" title="负责而谨慎地提交自己的代码"></a>负责而谨慎地提交自己的代码</h4><p>SVN更新的原则是要随时更新，随时提交。当完成了一个小功能，能够通过编译并且并且自己测试之后，谨慎地提交。<br>如果提交过程中产生了冲突，则需要同之前的开发人员联系，两个人一起协商解决冲突，解决冲突之后，需要两人一起测试保证解决冲突之后，程序不会影响其他功能。<br>如果提交过程中产生了更新，则也是需要重新编译并且完成自己的一些必要测试，再进行提交。</p>
<h4 id="保持原子性的提交"><a href="#保持原子性的提交" class="headerlink" title="保持原子性的提交"></a>保持原子性的提交</h4><p>每次提交的间歇尽可能地短，以一个小时，两个小时的开发工作为宜。如在更改UI界面的时候，可以每完成一个UI界面的修改或者设计，就提交一次。在开发功能模块的时候，可以每完成一个小细节功能的测试，就提交一次，在修改bug的时候，每修改掉一个bug并且确认修改了这个bug，也就提交一次。我们提倡多提交，也就能多为代码添加上保险。</p>
<h4 id="不要提交自动生成的文件"><a href="#不要提交自动生成的文件" class="headerlink" title="不要提交自动生成的文件"></a>不要提交自动生成的文件</h4><p>Visual Studio在生成过程中会产生很多自动文件，如.suo等配置文件，Debug,Release,Obj等编译文件，以及其他的一些自动生成，同编译代码无关的文件，这些文件在提交的时候不应该签入，如果不小心签入了，需要使用Delete命令从仓库中删除。</p>
<p>不要提交不能通过编译的代码<br>代码在提交之前，首先要确认自己能够在本地编译。如果在代码中使用了第三方类库，要考虑到项目组成员中有些成员可能没有安装相应的第三方类库或者没有放入GAC（针对.Net Framework）中，项目经理在准备项目工作区域的时候，需要考虑到这样的情况，确保开发小组成员在签出代码之后能够在统一的环境中进行编译。</p>
<h4 id="不要提交自己不明白的代码"><a href="#不要提交自己不明白的代码" class="headerlink" title="不要提交自己不明白的代码"></a>不要提交自己不明白的代码</h4><p>代码在提交入SVN之后，你的代码将被项目成员所分享。如果提交了你不明白的代码，你看不懂，别人也看不懂，如果在以后出现了问题将会成为项目质量的隐患。因此在引入任何第三方代码之前，确保你对这个代码有一个很清晰的了解。</p>
<h4 id="提前宣布自己的工作计划"><a href="#提前宣布自己的工作计划" class="headerlink" title="提前宣布自己的工作计划"></a>提前宣布自己的工作计划</h4><p>在自己准备开始进行某项功能的修改之前，先给工作小组的成员谈谈自己的修改计划，让大家都能了解你的思想，了解你即将对软件作出的修改，这样能尽可能的减少在开发过程中可能出现的冲突，提高开发效率。同时你也能够在和成员的交流中发现自己之前设计的不足，完善你的设计。</p>
<h4 id="对提交的信息采用明晰的标注"><a href="#对提交的信息采用明晰的标注" class="headerlink" title="对提交的信息采用明晰的标注"></a>对提交的信息采用明晰的标注</h4><p>+) 表示增加了功能<br>*) 表示对某些功能进行了更改<br>-) 表示删除了文件，或者对某些功能进行了裁剪，删除，屏蔽。<br>b) 表示修正了具体的某个bug</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/10/11/spring-transactional/" itemprop="url">
                  Spring @Transactional配置
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-10-11T13:38:47+08:00" content="2016 年 10 月 11 日">
              2016 年 10 月 11 日
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/JavaEE/" itemprop="url" rel="index">
                    <span itemprop="name">JavaEE</span>
                  </a>
                </span>

                
                
                  ， 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/JavaEE/Spring/" itemprop="url" rel="index">
                    <span itemprop="name">Spring</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/10/11/spring-transactional/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/10/11/spring-transactional/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2016/10/11/spring-transactional/" class="leancloud_visitors" data-flag-title="Spring @Transactional配置">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在service类前加上@Transactional，声明这个service所有方法需要事务管理。每一个业务方法开始时都会打开一个事务。</p>
<p>Spring默认情况下会对运行期例外(RunTimeException)进行事务回滚。这个例外是unchecked<br>如果遇到checked意外就不回滚。<br>如何改变默认规则：</p>
<p>1 让checked例外也回滚：在整个方法前加上<br>@Transactional(rollbackFor=Exception.class)</p>
<p>2 让unchecked例外不回滚：<br>@Transactional(notRollbackFor=RunTimeException.class)</p>
<p>3 不需要事务管理的(只查询的)方法：<br>@Transactional(propagation=Propagation.NOT_SUPPORTED)</p>
<p>注意： 如果异常被try｛｝catch｛｝了，事务就不回滚了，如果想让事务回滚必须再往外抛try｛｝catch｛throw Exception｝。</p>
<p>@Transactional设置：<br>propagation：事务传播性设置，Propagation枚举类型。Spring支持的事务传播属性包括7种：<br>    PROPAGATION_MANDATORY：方法必须在事务中执行，否则抛出异常。<br>    PROPAGATION_NESTED：使方法运行在嵌套事务中，否则和PROPAGATION_REQUIRED一样。<br>    PROPAGATION_NEVER ：当前方法永远不在事务中运行，否则抛出异常。<br>    PROPAGATION_NOT_SUPPORTED：定义为当前事务不支持的方法，在该方法执行期间正在运行的事务会被暂停<br>    PROPAGATION_REQUIRED：当前的方法必须运行在事务中，如果没有事务就新建一个事务。新事务和方法一起开始，随着方法返回或者抛出异常时终止。<br>    PROPAGATION_REQUIRED_NEW ：当前方法必须新建一个事务，如果当前的事务正在运行则暂停。<br>    PROPAGATION_SUPPORTS ：规定当前方法支持当前事务，但是如果没有事务在运行就使用非事务方法执行。<br>isolation：事务隔离性级别设置，Isolation枚举类型<br>    ISOLATION_DEFAULT ：使用数据库默认的隔离级别<br>    ISOLATION_COMMITTED：允许其他事务已经提交的更新（防止脏读取）<br>    ISOLATION_READ_UNCOMMITTED：允许读取其他事务未提交的更新，会导致三个缺陷发生。执行速度最快<br>    ISOLATION_REPEATABLE_READ ：除非事务自身更改了数据，否则事务多次读取的数据相同（防止脏数据，多次重复读取）<br>    ISOLATION_SERIALIZABLE：隔离级别最高，可以防止三个缺陷，但是速度最慢，影响性能。</p>
<p>readOnly：读写性事务，只读性事务，布尔型<br>    对数据库的操作中，查询是使用最频繁的操作，每次执行查询时都要从数据库中重新读取数据，有时多次读取的数据都是相同的，这样的数据操作不仅浪费了系统资源，还影响了系统速度。对访问量大的程序来说，节省这部分资源可以大大提    升系统速度。<br>   将事务声明为只读的，那么数据库可以根据事务的特性优化事务的读取操作</p>
<p>timeout：超时时间，单位秒<br>事务可能因为某种原因很长时间没有反应，这期间可能锁定了数据库表，影响性能。设置超时时间，如果超过该时间，事务自动回滚。</p>
<p>rollbackFor：一组异常类的实例，遇到时必须进行回滚<br>rollbackForClassname：一组异常类的名字，遇到时必须进行回滚<br>noRollbackFor：一组异常类的实例，遇到时必须不回滚<br>noRollbackForClassname：一组异常类的名字，遇到时必须不回滚</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/02/17/scrapy-five-module/" itemprop="url">
                  Scrapy五大组件介绍
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-02-17T18:27:11+08:00" content="2016 年 02 月 17 日">
              2016 年 02 月 17 日
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/爬虫/" itemprop="url" rel="index">
                    <span itemprop="name">爬虫</span>
                  </a>
                </span>

                
                
                  ， 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/爬虫/Scrapy/" itemprop="url" rel="index">
                    <span itemprop="name">Scrapy</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/02/17/scrapy-five-module/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/02/17/scrapy-five-module/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2016/02/17/scrapy-five-module/" class="leancloud_visitors" data-flag-title="Scrapy五大组件介绍">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Scrapy框架主要由五大组件组成，它们分别是调度器(Scheduler)、下载器(Downloader)、爬虫（Spider）和实体管道(Item Pipeline)、Scrapy引擎(Scrapy Engine)。下面我们分别介绍各个组件的作用。</p>
<h3 id="调度器"><a href="#调度器" class="headerlink" title="调度器"></a>调度器</h3><p>调度器，说白了可以想像成一个URL（抓取网页的网址或者说是链接）的优先队列，由它来决定下一个要抓取的网址是什么，同时去除重复的网址（不做无用功）。用户可以跟据自己的需求定制调度器。</p>
<h3 id="下载器"><a href="#下载器" class="headerlink" title="下载器"></a>下载器</h3><p>下载器，是所有组件中负担最大的，它用于高速地下载网络上的资源。Scrapy的下载器代码不会太复杂，但效率高，主要的原因是Scrapy下载器是建立在twisted这个高效的异步模型上的(其实整个框架都在建立在这个模型上的)。</p>
<h3 id="爬虫"><a href="#爬虫" class="headerlink" title="爬虫"></a>爬虫</h3><p>爬虫，是用户最关心的部份。用户定制自己的爬虫，用于从特定的网页中提取自己需要的信息，即所谓的实体(Item)。用户也可以从中提取出链接,让Scrapy继续抓取下一个页面。</p>
<h3 id="实体管道"><a href="#实体管道" class="headerlink" title="实体管道"></a>实体管道</h3><p>实体管道，用于处理爬虫提取的实体。主要的功能是持久化实体、验证实体的有效性、清除不需要的信息。</p>
<h3 id="Scrapy引擎"><a href="#Scrapy引擎" class="headerlink" title="Scrapy引擎"></a>Scrapy引擎</h3><p>Scrapy引擎是整个框架的核心。它用来控制调试器、下载器、爬虫。实际上，引擎相当于计算机的CPU,它控制着整个流程。</p>
<h2 id="Scrapy运行流程"><a href="#Scrapy运行流程" class="headerlink" title="Scrapy运行流程"></a>Scrapy运行流程</h2><p><img src="http://ww1.sinaimg.cn/large/005LZfaWgy1fcyi9y62cxj30jg0dqmzl" alt=""></p>
<ol>
<li>首先，引擎从调度器中取出一个链接(URL)用于接下来的抓取</li>
<li>引擎把URL封装成一个请求(Request)传给下载器，下载器把资源下载下来，并封装成应答包(Response)</li>
<li>然后，爬虫解析Response</li>
<li>若是解析出实体（Item）,则交给实体管道进行进一步的处理。</li>
<li>若是解析出的是链接（URL）,则把URL交给Scheduler等待抓取</li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/09/07/linux-mysql-error/" itemprop="url">
                  Starting MySQL. ERROR
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-09-07T22:51:26+08:00" content="2015 年 09 月 07 日">
              2015 年 09 月 07 日
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/09/07/linux-mysql-error/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2015/09/07/linux-mysql-error/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2015/09/07/linux-mysql-error/" class="leancloud_visitors" data-flag-title="Starting MySQL. ERROR">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="Starting-MySQL-ERROR-The-server-quit-without-updating-PID-file-var-lib-mysql-iZ94mck3376Z-pid"><a href="#Starting-MySQL-ERROR-The-server-quit-without-updating-PID-file-var-lib-mysql-iZ94mck3376Z-pid" class="headerlink" title="Starting MySQL. ERROR! The server quit without updating PID file (/var/lib/mysql/iZ94mck3376Z.pid)."></a>Starting MySQL. ERROR! The server quit without updating PID file (/var/lib/mysql/iZ94mck3376Z.pid).</h3><pre><code>[root@snsgou mysql]# service mysql restart
MySQL server PID file could not be found![失败]
Starting MySQL...The server quit without updating PID file (/usr/local/mysql/data/snsgou.pid).[失败]
</code></pre><p>Google了下 ，问题可能的原因有多种，具体什么原因最好的办法是先查看下错误日志：</p>
<h4 id="1、可能是-usr-local-mysql-data-mysql-pid文件没有写的权限"><a href="#1、可能是-usr-local-mysql-data-mysql-pid文件没有写的权限" class="headerlink" title="1、可能是/usr/local/mysql/data/mysql.pid文件没有写的权限"></a>1、可能是/usr/local/mysql/data/mysql.pid文件没有写的权限</h4><p>解决方法 ：给予权限，执行 “chown -R mysql:mysql /var/data” “chmod -R 755 /usr/local/mysql/data”  然后重新启动mysqld！</p>
<h4 id="2、可能进程里已经存在mysql进程"><a href="#2、可能进程里已经存在mysql进程" class="headerlink" title="2、可能进程里已经存在mysql进程"></a>2、可能进程里已经存在mysql进程</h4><p>解决方法：用命令“ps -ef|grep mysqld”查看是否有mysqld进程，如果有使用“kill -9  进程号”杀死，然后重新启动mysqld！</p>
<h4 id="3、可能是第二次在机器上安装mysql，有残余数据影响了服务的启动。"><a href="#3、可能是第二次在机器上安装mysql，有残余数据影响了服务的启动。" class="headerlink" title="3、可能是第二次在机器上安装mysql，有残余数据影响了服务的启动。"></a>3、可能是第二次在机器上安装mysql，有残余数据影响了服务的启动。</h4><p>解决方法：去mysql的数据目录/data看看，如果存在mysql-bin.index，就赶快把它删除掉吧，它就是罪魁祸首了。本人就是使用第三条方法解决的 ！</p>
<h4 id="4、mysql在启动时没有指定配置文件时会使用-etc-my-cnf配置文件，请打开这个文件查看在-mysqld-节下有没有指定数据目录-datadir-。"><a href="#4、mysql在启动时没有指定配置文件时会使用-etc-my-cnf配置文件，请打开这个文件查看在-mysqld-节下有没有指定数据目录-datadir-。" class="headerlink" title="4、mysql在启动时没有指定配置文件时会使用/etc/my.cnf配置文件，请打开这个文件查看在[mysqld]节下有没有指定数据目录(datadir)。"></a>4、mysql在启动时没有指定配置文件时会使用/etc/my.cnf配置文件，请打开这个文件查看在[mysqld]节下有没有指定数据目录(datadir)。</h4><p>解决方法：请在[mysqld]下设置这一行：datadir = /usr/local/mysql/data</p>
<h4 id="5、skip-federated字段问题"><a href="#5、skip-federated字段问题" class="headerlink" title="5、skip-federated字段问题"></a>5、skip-federated字段问题</h4><p>解决方法：检查一下/etc/my.cnf文件中有没有没被注释掉的skip-federated字段，如果有就立即注释掉吧。</p>
<h4 id="6、错误日志目录不存在"><a href="#6、错误日志目录不存在" class="headerlink" title="6、错误日志目录不存在"></a>6、错误日志目录不存在</h4><p>解决方法：使用“chown” “chmod”命令赋予mysql所有者及权限</p>
<h4 id="7、selinux惹的祸，如果是centos系统，默认会开启selinux"><a href="#7、selinux惹的祸，如果是centos系统，默认会开启selinux" class="headerlink" title="7、selinux惹的祸，如果是centos系统，默认会开启selinux"></a>7、selinux惹的祸，如果是centos系统，默认会开启selinux</h4><p>解决方法：关闭它，打开/etc/selinux/config，把SELINUX=enforcing改为SELINUX=disabled后存盘退出重启机器试试。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/09/04/hibernate-language/" itemprop="url">
                  Hibernate查询语言
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-09-04T10:12:26+08:00" content="2015 年 09 月 04 日">
              2015 年 09 月 04 日
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/JavaEE/" itemprop="url" rel="index">
                    <span itemprop="name">JavaEE</span>
                  </a>
                </span>

                
                
                  ， 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/JavaEE/Hibernate/" itemprop="url" rel="index">
                    <span itemprop="name">Hibernate</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/09/04/hibernate-language/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2015/09/04/hibernate-language/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2015/09/04/hibernate-language/" class="leancloud_visitors" data-flag-title="Hibernate查询语言">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="HQL-Hibernate查询语言"><a href="#HQL-Hibernate查询语言" class="headerlink" title="HQL: Hibernate查询语言"></a>HQL: Hibernate查询语言</h2><p>Hibernate配备了一种非常强大的查询语言，这种语言看上去很像SQL。但是不要被语法结构 上的相似所迷惑，HQL是非常有意识的被设计为完全面向对象的查询，它可以理解如继承、多态 和关联之类的概念。</p>
<p>Hibernate配备了一种非常强大的查询语言，这种语言看上去很像SQL。但是不要被语法结构 上的相似所迷惑，HQL是非常有意识的被设计为完全面向对象的查询，它可以理解如继承、多态 和关联之类的概念。</p>
<h3 id="1-大小写敏感性问题"><a href="#1-大小写敏感性问题" class="headerlink" title="1. 大小写敏感性问题"></a>1. 大小写敏感性问题</h3><p>除了Java类与属性的名称外，查询语句对大小写并不敏感。 所以 SeLeCT 与 sELEct 以及 SELECT 是相同的，但是 org.hibernate.eg.FOO 并不等价于org.hibernate.eg.Foo 并且 foo.barSet 也不等价于 foo.BARSET。<br>本手册中的HQL关键字将使用小写字母. 很多用户发现使用完全大写的关键字会使查询语句 的可读性更强, 但我们发现，当把查询语句嵌入到Java语句中的时候使用大写关键字比较难看。</p>
<h3 id="2-from子句"><a href="#2-from子句" class="headerlink" title="2. from子句"></a>2. from子句</h3><p>Hibernate中最简单的查询语句的形式如下：</p>
<pre><code>from eg.Cat
</code></pre><p>该子句简单的返回eg.Cat类的所有实例。 通常我们不需要使用类的全限定名, 因为 auto-import（自动引入） 是缺省的情况。 所以我们几乎只使用如下的简单写法：</p>
<pre><code>from Cat
</code></pre><p>大多数情况下, 你需要指定一个别名, 原因是你可能需要 在查询语句的其它部分引用到Cat</p>
<pre><code>from Cat as cat
</code></pre><p>这个语句把别名cat指定给类Cat 的实例, 这样我们就可以在随后的查询中使用此别名了。 关键字as 是可选的，我们也可以这样写:</p>
<pre><code>from Cat cat
</code></pre><p>子句中可以同时出现多个类, 其查询结果是产生一个笛卡儿积或产生跨表的连接。</p>
<pre><code>from Formula, Parameter
from Formula as form, Parameter as param
</code></pre><p>查询语句中别名的开头部分小写被认为是实践中的好习惯， 这样做与Java变量的命名标准保持了一致 (比如，domesticCat)。</p>
<h3 id="3-关联-Association-与连接-Join"><a href="#3-关联-Association-与连接-Join" class="headerlink" title="3. 关联(Association)与连接(Join)"></a>3. 关联(Association)与连接(Join)</h3><p>我们也可以为相关联的实体甚至是对一个集合中的全部元素指定一个别名, 这时要使用关键字join。</p>
<pre><code>from Cat as cat 
    inner join cat.mate as mate
    left outer join cat.kittens as kitten

from Cat as cat left join cat.mate.kittens as kittens
from Formula form full join form.parameter param
</code></pre><p>受支持的连接类型是从ANSI SQL中借鉴来的。</p>
<ul>
<li>inner join（内连接）</li>
<li>left outer join（左外连接）</li>
<li>right outer join（右外连接）</li>
<li>full join (全连接，并不常用)</li>
</ul>
<p>语句inner join, left outer join 以及 right outer join 可以简写。</p>
<pre><code>from Cat as cat 
    join cat.mate as mate
    left join cat.kittens as kitten
</code></pre><p>还有，一个”fetch”连接允许仅仅使用一个选择语句就将相关联的对象或一组值的集合随着他们的父对象的初始化而被初始化，这种方法在使用到集合的情况下尤其有用，对于关联和集合来说，它有效的代替了映射文件中的外联接 与延迟声明（lazy declarations）. </p>
<pre><code>from Cat as cat 
    inner join fetch cat.mate
    left join fetch cat.kittens
</code></pre><p>一个fetch连接通常不需要被指定别名, 因为相关联的对象不应当被用在 where 子句 (或其它任何子句)中。同时，相关联的对象并不在查询的结果中直接返回，但可以通过他们的父对象来访问到他们。</p>
<p>注意fetch构造变量在使用了scroll() 或 iterate()函数的查询中是不能使用的。最后注意，使用full join fetch 与 right join fetch是没有意义的。</p>
<p>如果你使用属性级别的延迟获取（lazy fetching）（这是通过重新编写字节码实现的），可以使用 fetch all properties 来强制Hibernate立即取得那些原本需要延迟加载的属性（在第一个查询中）。</p>
<pre><code>from Document fetch all properties order by name
from Document doc fetch all properties where lower(doc.name) like &apos;%cats%&apos;
</code></pre><h3 id="4-select子句"><a href="#4-select子句" class="headerlink" title="4. select子句"></a>4. select子句</h3><p>select 子句选择将哪些对象与属性返 回到查询结果集中. 考虑如下情况:</p>
<pre><code>select mate 
from Cat as cat 
    inner join cat.mate as mate
</code></pre><p>该语句将选择mates of other Cats。（其他猫的配偶） 实际上, 你可以更简洁的用以下的查询语句表达相同的含义:</p>
<pre><code>select cat.mate from Cat cat
</code></pre><p>查询语句可以返回值为任何类型的属性，包括返回类型为某种组件(Component)的属性:</p>
<pre><code>select cat.name from DomesticCat cat
where cat.name like &apos;fri%&apos;
select cust.name.firstName from Customer as cust
</code></pre><p>查询语句可以返回多个对象和（或）属性，存放在 Object[]队列中,</p>
<pre><code>select mother, offspr, mate.name 
from DomesticCat as mother
    inner join mother.mate as mate
    left outer join mother.kittens as offspr
</code></pre><p>或存放在一个List对象中,</p>
<pre><code>select new list(mother, offspr, mate.name)
from DomesticCat as mother
    inner join mother.mate as mate
    left outer join mother.kittens as offspr
</code></pre><p>也可能直接返回一个实际的类型安全的Java对象,</p>
<pre><code>select new Family(mother, mate, offspr)
from DomesticCat as mother
    join mother.mate as mate
    left join mother.kittens as offspr
</code></pre><p>假设类Family有一个合适的构造函数.<br>你可以使用关键字as给“被选择了的表达式”指派别名:</p>
<pre><code>select max(bodyWeight) as max, min(bodyWeight) as min, count(*) as n
from Cat cat
</code></pre><p>这种做法在与子句select new map一起使用时最有用:</p>
<pre><code>select new map( max(bodyWeight) as max, min(bodyWeight) as min, count(*) as n )
from Cat cat
</code></pre><p>该查询返回了一个Map的对象，内容是别名与被选择的值组成的名-值映射。</p>
<h3 id="5-聚集函数"><a href="#5-聚集函数" class="headerlink" title="5. 聚集函数"></a>5. 聚集函数</h3><p>HQL查询甚至可以返回作用于属性之上的聚集函数的计算结果:</p>
<pre><code>select avg(cat.weight), sum(cat.weight), max(cat.weight), count(cat)
from Cat cat
</code></pre><p>受支持的聚集函数如下：<br>avg(…), sum(…), min(…), max(…)<br>count(*)<br>count(…), count(distinct …), count(all…)</p>
<p>你可以在选择子句中使用数学操作符、连接以及经过验证的SQL函数：</p>
<pre><code>select cat.weight + sum(kitten.weight) 
from Cat cat 
    join cat.kittens kitten
group by cat.id, cat.weight
select firstName||&apos; &apos;||initial||&apos; &apos;||upper(lastName) from Person
</code></pre><p>关键字distinct与all 也可以使用，它们具有与SQL相同的语义.</p>
<pre><code>select distinct cat.name from Cat cat

select count(distinct cat.name), count(cat) from Cat cat
</code></pre><h3 id="6-多态查询"><a href="#6-多态查询" class="headerlink" title="6. 多态查询"></a>6. 多态查询</h3><p>一个如下的查询语句:</p>
<pre><code>from Cat as cat
</code></pre><p>不仅返回Cat类的实例, 也同时返回子类 DomesticCat的实例. Hibernate 可以在from子句中指定任何 Java 类或接口. 查询会返回继承了该类的所有持久化子类 的实例或返回声明了该接口的所有持久化类的实例。下面的查询语句返回所有的被持久化的对象：</p>
<pre><code>from java.lang.Object o
</code></pre><p>接口Named 可能被各种各样的持久化类声明：</p>
<pre><code>from Named n, Named m where n.name = m.name
</code></pre><p>注意，最后的两个查询将需要超过一个的SQL SELECT.这表明order by子句 没有对整个结果集进行正确的排序. (这也说明你不能对这样的查询使用Query.scroll()方法.)</p>
<h3 id="7-where子句"><a href="#7-where子句" class="headerlink" title="7. where子句"></a>7. where子句</h3><p>where子句允许你将返回的实例列表的范围缩小. 如果没有指定别名，你可以使用属性名来直接引用属性:</p>
<pre><code>from Cat where name=&apos;Fritz&apos;
</code></pre><p>如果指派了别名，需要使用完整的属性名:</p>
<pre><code>from Cat as cat where cat.name=&apos;Fritz&apos;
</code></pre><p>返回名为（属性name等于）’Fritz’的Cat类的实例。</p>
<pre><code>select foo 
from Foo foo, Bar bar
where foo.startDate = bar.date
</code></pre><p>将返回所有满足下面条件的Foo类的实例： 存在如下的bar的一个实例，其date属性等于 Foo的startDate属性。 复合路径表达式使得where子句非常的强大，考虑如下情况：</p>
<pre><code>from Cat cat where cat.mate.name is not null
</code></pre><p>该查询将被翻译成为一个含有表连接（内连接）的SQL查询。如果你打算写像这样的查询语句</p>
<pre><code>from Foo foo  
where foo.bar.baz.customer.address.city is not null
</code></pre><p>在SQL中，你为达此目的将需要进行一个四表连接的查询。<br>=运算符不仅可以被用来比较属性的值，也可以用来比较实例：</p>
<pre><code>from Cat cat, Cat rival where cat.mate = rival.mate
select cat, mate 
from Cat cat, Cat mate
where cat.mate = mate
</code></pre><p>特殊属性（小写）id可以用来表示一个对象的唯一的标识符。（你也可以使用该对象的属性名。）</p>
<pre><code>from Cat as cat where cat.id = 123

from Cat as cat where cat.mate.id = 69
</code></pre><p>第二个查询是有效的。此时不需要进行表连接！<br>同样也可以使用复合标识符。比如Person类有一个复合标识符，它由country属性 与medicareNumber属性组成。</p>
<pre><code>from bank.Person person
where person.id.country = &apos;AU&apos; 
    and person.id.medicareNumber = 123456
from bank.Account account
where account.owner.id.country = &apos;AU&apos; 
    and account.owner.id.medicareNumber = 123456
</code></pre><p>第二个查询也不需要进行表连接。<br>同样的，特殊属性class在进行多态持久化的情况下被用来存取一个实例的鉴别值（discriminator value）。 一个嵌入到where子句中的Java类的名字将被转换为该类的鉴别值。</p>
<pre><code>from Cat cat where cat.class = DomesticCat
</code></pre><p>你也可以声明一个属性的类型是组件或者复合用户类型（以及由组件构成的组件等等）。永远不要尝试使用以组件类型来结尾的路径表达式（path-expression） （与此相反，你应当使用组件的一个属性来结尾）。 </p>
<p>举例来说，如果store.owner含有一个包含了组件的实体address<br>store.owner.address.city    // 正确<br>store.owner.address         // 错误!<br>一个“任意”类型有两个特殊的属性id和class, 来允许我们按照下面的方式表达一个连接（AuditLog.item 是一个属性，该属性被映射为<any>）。</any></p>
<pre><code>from AuditLog log, Payment payment 
where log.item.class = &apos;Payment&apos; and log.item.id = payment.id
</code></pre><p>注意，在上面的查询与句中，log.item.class 和 payment.class 将涉及到完全不同的数据库中的列。</p>
<h3 id="8-表达式"><a href="#8-表达式" class="headerlink" title="8. 表达式"></a>8. 表达式</h3><p>在where子句中允许使用的表达式包括 大多数你可以在SQL使用的表达式种类:</p>
<p>数学运算符+, -, *, /<br>二进制比较运算符=, &gt;=, &lt;=, &lt;&gt;, !=, like<br>逻辑运算符and, or, not<br>in, not in, between, is null, is not null, is empty, is not empty, member of and not member of<br>“简单的” case, case … when … then … else … end,和 “搜索” case, case when … then … else … end<br>字符串连接符…||… or concat(…,…)<br>current_date(), current_time(), current_timestamp()<br>second(…), minute(…), hour(…), day(…), month(…), year(…),<br>EJB-QL 3.0定义的任何函数或操作：substring(), trim(), lower(), upper(), length(), locate(), abs(), sqrt(), bit_length()<br>coalesce() 和 nullif()<br>cast(… as …), 其第二个参数是某Hibernate类型的名字，以及extract(… from …)，只要ANSI cast() 和 extract() 被底层数据库支持<br>任何数据库支持的SQL标量函数，比如sign(), trunc(), rtrim(), sin()</p>
<p>JDBC参数传入 ?<br>命名参数:name, :start_date, :x1<br>SQL 直接常量 ‘foo’, 69, ‘1970-01-01 10:00:01.0’<br>Java public static final 类型的常量 eg.Color.TABBY</p>
<p>关键字in与between可按如下方法使用:</p>
<pre><code>from DomesticCat cat where cat.name between &apos;A&apos; and &apos;B&apos;
from DomesticCat cat where cat.name in ( &apos;Foo&apos;, &apos;Bar&apos;, &apos;Baz&apos; )
</code></pre><p>而且否定的格式也可以如下书写：</p>
<pre><code>from DomesticCat cat where cat.name not between &apos;A&apos; and &apos;B&apos;
from DomesticCat cat where cat.name not in ( &apos;Foo&apos;, &apos;Bar&apos;, &apos;Baz&apos; )
</code></pre><p>同样, 子句is null与is not null可以被用来测试空值(null).<br>在Hibernate配置文件中声明HQL“查询替代（query substitutions）”之后， 布尔表达式（Booleans）可以在其他表达式中轻松的使用:</p>
<pre><code>&lt;property name=&quot;hibernate.query.substitutions&quot;&gt;true 1, false 0&lt;/property&gt;
</code></pre><p>系统将该HQL转换为SQL语句时，该设置表明将用字符 1 和 0 来 取代关键字true 和 </p>
<pre><code>false:
from Cat cat where cat.alive = true
</code></pre><p>你可以用特殊属性size, 或是特殊函数size()测试一个集合的大小。</p>
<pre><code>from Cat cat where cat.kittens.size &gt; 0
from Cat cat where size(cat.kittens) &gt; 0
</code></pre><p>对于索引了（有序）的集合，你可以使用minindex 与 maxindex函数来引用到最小与最大的索引序数。 同理，你可以使用minelement 与 maxelement函数来 引用到一个基本数据类型的集合中最小与最大的元素。</p>
<pre><code>from Calendar cal where maxelement(cal.holidays) &gt; current date
from Order order where maxindex(order.items) &gt; 100
from Order order where minelement(order.items) &gt; 10000
</code></pre><p>在传递一个集合的索引集或者是元素集(elements与indices 函数) 或者传递一个子查询的结果的时候，可以使用SQL函数any, some, all, exists, in</p>
<pre><code>select mother from Cat as mother, Cat as kit
where kit in elements(foo.kittens)
select p from NameList list, Person p
where p.name = some elements(list.names)
from Cat cat where exists elements(cat.kittens)
from Player p where 3 &gt; all elements(p.scores)
from Show show where &apos;fizard&apos; in indices(show.acts)
</code></pre><p>注意，在Hibernate3种，这些结构变量- size, elements, indices, minindex, maxindex, minelement, maxelement - 只能在where子句中使用。<br>一个被索引过的（有序的）集合的元素(arrays, lists, maps)可以在其他索引中被引用（只能在where子句中）：</p>
<pre><code>from Order order where order.items[0].id = 1234
select person from Person person, Calendar calendar
where calendar.holidays[&apos;national day&apos;] = person.birthDay
    and person.nationality.calendar = calendar
select item from Item item, Order order
where order.items[ order.deliveredItemIndices[0] ] = item and order.id = 11
select item from Item item, Order order
where order.items[ maxindex(order.items) ] = item and order.id = 11
</code></pre><p>在[]中的表达式甚至可以是一个算数表达式。</p>
<pre><code>select item from Item item, Order order
where order.items[ size(order.items) - 1 ] = item
</code></pre><p>对于一个一对多的关联（one-to-many association）或是值的集合中的元素， HQL也提供内建的index()函数，</p>
<pre><code>select item, index(item) from Order order 
    join order.items item
where index(item) &lt; 5
</code></pre><p>如果底层数据库支持标量的SQL函数，它们也可以被使用</p>
<pre><code>from DomesticCat cat where upper(cat.name) like &apos;FRI%&apos;
</code></pre><p>如果你还不能对所有的这些深信不疑，想想下面的查询。如果使用SQL，语句长度会增长多少，可读性会下降多少：</p>
<pre><code>select cust
from Product prod,
    Store store
    inner join store.customers cust
where prod.name = &apos;widget&apos;
    and store.location.name in ( &apos;Melbourne&apos;, &apos;Sydney&apos; )
    and prod = all elements(cust.currentOrder.lineItems)
</code></pre><p>提示: 会像如下的语句</p>
<pre><code>SELECT cust.name, cust.address, cust.phone, cust.id, cust.current_order
FROM customers cust,
    stores store,
    locations loc,
    store_customers sc,
    product prod
WHERE prod.name = &apos;widget&apos;
    AND store.loc_id = loc.id
    AND loc.name IN ( &apos;Melbourne&apos;, &apos;Sydney&apos; )
    AND sc.store_id = store.id
    AND sc.cust_id = cust.id
    AND prod.id = ALL(
        SELECT item.prod_id
        FROM line_items item, orders o
        WHERE item.order_id = o.id
            AND cust.current_order = o.id
    )
</code></pre><h3 id="9-order-by子句"><a href="#9-order-by子句" class="headerlink" title="9. order by子句"></a>9. order by子句</h3><p>查询返回的列表(list)可以按照一个返回的类或组件（components)中的任何属性（property）进行排序：</p>
<pre><code>from DomesticCat cat
order by cat.name asc, cat.weight desc, cat.birthdate
</code></pre><p>可选的asc或desc关键字指明了按照升序或降序进行排序.</p>
<h3 id="10-group-by子句"><a href="#10-group-by子句" class="headerlink" title="10. group by子句"></a>10. group by子句</h3><p>一个返回聚集值(aggregate values)的查询可以按照一个返回的类或组件（components)中的任何属性（property）进行分组：</p>
<pre><code>select cat.color, sum(cat.weight), count(cat) 
from Cat cat
group by cat.color
select foo.id, avg(name), max(name) 
from Foo foo join foo.names name
group by foo.id
</code></pre><p>having子句在这里也允许使用.</p>
<pre><code>select cat.color, sum(cat.weight), count(cat) 
from Cat cat
group by cat.color 
having cat.color in (eg.Color.TABBY, eg.Color.BLACK)
</code></pre><p>如果底层的数据库支持的话(例如不能在MySQL中使用)，SQL的一般函数与聚集函数也可以出现 在having与order by 子句中。</p>
<pre><code>select cat
from Cat cat
    join cat.kittens kitten
group by cat
having avg(kitten.weight) &gt; 100
order by count(kitten) asc, sum(kitten.weight) desc
</code></pre><p>注意group by子句与 order by子句中都不能包含算术表达式（arithmetic expressions）.</p>
<h3 id="11-子查询"><a href="#11-子查询" class="headerlink" title="11. 子查询"></a>11. 子查询</h3><p>对于支持子查询的数据库，Hibernate支持在查询中使用子查询。一个子查询必须被圆括号包围起来（经常是SQL聚集函数的圆括号）。 甚至相互关联的子查询（引用到外部查询中的别名的子查询）也是允许的。</p>
<pre><code>from Cat as fatcat 
where fatcat.weight &gt; ( 
    select avg(cat.weight) from DomesticCat cat 
)
from DomesticCat as cat 
where cat.name = some ( 
    select name.nickName from Name as name 
)
from Cat as cat 
where not exists ( 
    from Cat as mate where mate.mate = cat 
)
from DomesticCat as cat 
where cat.name not in ( 
    select name.nickName from Name as name 
)
</code></pre><p>在select列表中包含一个表达式以上的子查询，你可以使用一个元组构造符（tuple constructors）：</p>
<pre><code>from Cat as cat 
where not ( cat.name, cat.color ) in ( 
    select cat.name, cat.color from DomesticCat cat 
)
</code></pre><p>注意在某些数据库中（不包括Oracle与HSQL），你也可以在其他语境中使用元组构造符， 比如查询用户类型的组件与组合：</p>
<pre><code>from Person where name = (&apos;Gavin&apos;, &apos;A&apos;, &apos;King&apos;)
</code></pre><p>该查询等价于更复杂的：</p>
<pre><code>from Person where name.first = &apos;Gavin&apos; and name.initial = &apos;A&apos; and name.last = &apos;King&apos;)
</code></pre><p>有两个很好的理由使你不应当作这样的事情：首先，它不完全适用于各个数据库平台；其次，查询现在依赖于映射文件中属性的顺序。</p>
<h3 id="12-HQL示例"><a href="#12-HQL示例" class="headerlink" title="12. HQL示例"></a>12. HQL示例</h3><p>Hibernate查询可以非常的强大与复杂。实际上，Hibernate的一个主要卖点就是查询语句的威力。这里有一些例子，它们与我在最近的 一个项目中使用的查询非常相似。注意你能用到的大多数查询比这些要简单的多！<br>下面的查询对于某个特定的客户的所有未支付的账单，在给定给最小总价值的情况下，返回订单的id，条目的数量和总价值， 返回值按照总价值的结果进行排序。为了决定价格，查询使用了当前目录。作为转换结果的SQL查询，使用了ORDER, ORDER_LINE, PRODUCT, CATALOG 和PRICE 库表。</p>
<pre><code>select order.id, sum(price.amount), count(item)
from Order as order
    join order.lineItems as item
    join item.product as product,
    Catalog as catalog
    join catalog.prices as price
where order.paid = false
    and order.customer = :customer
    and price.product = product
    and catalog.effectiveDate &lt; sysdate
    and catalog.effectiveDate &gt;= all (
        select cat.effectiveDate 
        from Catalog as cat
        where cat.effectiveDate &lt; sysdate
    )
group by order
having sum(price.amount) &gt; :minAmount
order by sum(price.amount) desc
</code></pre><p>这简直是一个怪物！实际上，在现实生活中，我并不热衷于子查询，所以我的查询语句看起来更像这个：</p>
<pre><code>select order.id, sum(price.amount), count(item)
from Order as order
    join order.lineItems as item
    join item.product as product,
    Catalog as catalog
    join catalog.prices as price
where order.paid = false
    and order.customer = :customer
    and price.product = product
    and catalog = :currentCatalog
group by order
having sum(price.amount) &gt; :minAmount
order by sum(price.amount) desc
</code></pre><p>下面一个查询计算每一种状态下的支付的数目，除去所有处于AWAITING_APPROVAL状态的支付，因为在该状态下 当前的用户作出了状态的最新改变。该查询被转换成含有两个内连接以及一个相关联的子选择的SQL查询，该查询使用了表 PAYMENT, PAYMENT_STATUS 以及 PAYMENT_STATUS_CHANGE。</p>
<pre><code>select count(payment), status.name 
from Payment as payment 
    join payment.currentStatus as status
    join payment.statusChanges as statusChange
where payment.status.name &lt;&gt; PaymentStatus.AWAITING_APPROVAL
    or (
        statusChange.timeStamp = ( 
            select max(change.timeStamp) 
            from PaymentStatusChange change 
            where change.payment = payment
        )
        and statusChange.user &lt;&gt; :currentUser
    )
group by status.name, status.sortOrder
order by status.sortOrder
</code></pre><p>如果我把statusChanges实例集映射为一个列表（list）而不是一个集合（set）, 书写查询语句将更加简单.</p>
<pre><code>select count(payment), status.name 
from Payment as payment
    join payment.currentStatus as status
where payment.status.name &lt;&gt; PaymentStatus.AWAITING_APPROVAL
    or payment.statusChanges[ maxIndex(payment.statusChanges) ].user &lt;&gt; :currentUser
group by status.name, status.sortOrder
order by status.sortOrder
</code></pre><p>下面一个查询使用了MS SQL Server的 isNull()函数用以返回当前用户所属组织的组织帐号及组织未支付的账。 它被转换成一个对表ACCOUNT,PAYMENT, PAYMENT_STATUS, ACCOUNT_TYPE, ORGANIZATION 以及 ORG_USER进行的三个内连接， 一个外连接和一个子选择的SQL查询。</p>
<pre><code>select account, payment
from Account as account
    left outer join account.payments as payment
where :currentUser in elements(account.holder.users)
    and PaymentStatus.UNPAID = isNull(payment.currentStatus.name, PaymentStatus.UNPAID)
order by account.type.sortOrder, account.accountNumber, payment.dueDate
</code></pre><p>对于一些数据库，我们需要弃用（相关的）子选择。</p>
<pre><code>select account, payment
from Account as account
    join account.holder.users as user
    left outer join account.payments as payment
where :currentUser = user
    and PaymentStatus.UNPAID = isNull(payment.currentStatus.name, PaymentStatus.UNPAID)
order by account.type.sortOrder, account.accountNumber, payment.dueDate
</code></pre><h3 id="13-批量的UPDATE-amp-DELETE语句"><a href="#13-批量的UPDATE-amp-DELETE语句" class="headerlink" title="13. 批量的UPDATE &amp; DELETE语句"></a>13. 批量的UPDATE &amp; DELETE语句</h3><p>HQL现在支持UPDATE与DELETE语句. 查阅 第 14.3 节 “大批量更新/删除（Bulk update/delete）” 以获得更多信息。</p>
<h3 id="14-小技巧-amp-小窍门"><a href="#14-小技巧-amp-小窍门" class="headerlink" title="14. 小技巧 &amp; 小窍门"></a>14. 小技巧 &amp; 小窍门</h3><p>你可以统计查询结果的数目而不必实际的返回他们：<br>( (Integer) session.iterate(“select count(*) from ….”).next() ).intValue()<br>若想根据一个集合的大小来进行排序，可以使用如下的语句：</p>
<pre><code>select usr.id, usr.name
from User as usr 
    left join usr.messages as msg
group by usr.id, usr.name
order by count(msg)
</code></pre><p>如果你的数据库支持子选择，你可以在你的查询的where子句中为选择的大小（selection size）指定一个条件:</p>
<pre><code>from User usr where size(usr.messages) &gt;= 1
</code></pre><p>如果你的数据库不支持子选择语句，使用下面的查询：</p>
<pre><code>select usr.id, usr.name
from User usr.name
    join usr.messages msg
group by usr.id, usr.name
having count(msg) &gt;= 1
</code></pre><p>因为内连接（inner join）的原因，这个解决方案不能返回含有零个信息的User 类的实例, 所以这种情况下使用下面的格式将是有帮助的:</p>
<pre><code>select usr.id, usr.name
from User as usr
    left join usr.messages as msg
group by usr.id, usr.name
having count(msg) = 0
</code></pre><p>JavaBean的属性可以被绑定到一个命名查询（named query）的参数上：</p>
<pre><code>Query q = s.createQuery(&quot;from foo Foo as foo where foo.name=:name and foo.size=:size&quot;);
q.setProperties(fooBean); // fooBean包含方法getName()与getSize()
List foos = q.list();
</code></pre><p>通过将接口Query与一个过滤器（filter）一起使用，集合（Collections）是可以分页的：</p>
<pre><code>Query q = s.createFilter( collection, &quot;&quot; ); // 一个简单的过滤器
q.setMaxResults(PAGE_SIZE);
q.setFirstResult(PAGE_SIZE * pageNumber);
List page = q.list();
</code></pre><p>通过使用查询过滤器（query filter）可以将集合（Collection）的原素分组或排序:</p>
<pre><code>Collection orderedCollection = s.filter( collection, &quot;order by this.amount&quot; );
Collection counts = s.filter( collection, &quot;select this.type, count(this) group by this.type&quot; );
</code></pre><p>不用通过初始化，你就可以知道一个集合（Collection）的大小：</p>
<pre><code>( (Integer) session.iterate(&quot;select count(*) from ....&quot;).next() ).intValue();
</code></pre>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/08/29/springmvc4-date-json/" itemprop="url">
                  springmvc4-date-json
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-08-29T22:20:55+08:00" content="2015 年 08 月 29 日">
              2015 年 08 月 29 日
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/JavaEE/" itemprop="url" rel="index">
                    <span itemprop="name">JavaEE</span>
                  </a>
                </span>

                
                
                  ， 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/JavaEE/Springmvc/" itemprop="url" rel="index">
                    <span itemprop="name">Springmvc</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/08/29/springmvc4-date-json/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2015/08/29/springmvc4-date-json/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2015/08/29/springmvc4-date-json/" class="leancloud_visitors" data-flag-title="springmvc4-date-json">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="1、方法一：全局处理"><a href="#1、方法一：全局处理" class="headerlink" title="1、方法一：全局处理"></a>1、方法一：全局处理</h3><pre><code>&lt;mvc:annotation-driven&gt;  
    &lt;!-- 处理responseBody 里面日期类型 --&gt;  
        &lt;mvc:message-converters&gt;  
            &lt;bean class=&quot;org.springframework.http.converter.json.MappingJackson2HttpMessageConverter&quot;&gt;  
                &lt;property name=&quot;objectMapper&quot;&gt;  
                    &lt;bean class=&quot;com.fasterxml.jackson.databind.ObjectMapper&quot;&gt;  
                        &lt;property name=&quot;dateFormat&quot;&gt;  
                            &lt;bean class=&quot;java.text.SimpleDateFormat&quot;&gt;  
                                &lt;constructor-arg type=&quot;java.lang.String&quot; value=&quot;yyyy-MM-dd HH:mm:ss&quot; /&gt;  
                            &lt;/bean&gt;  
                        &lt;/property&gt;  
                    &lt;/bean&gt;  
                &lt;/property&gt;  
            &lt;/bean&gt;  
        &lt;/mvc:message-converters&gt;  
    &lt;/mvc:annotation-driven&gt;  
</code></pre><h3 id="方法二：局部注解处理"><a href="#方法二：局部注解处理" class="headerlink" title="方法二：局部注解处理"></a>方法二：局部注解处理</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line">import java.io.IOException;  </div><div class="line">import java.text.SimpleDateFormat;  </div><div class="line">import java.util.Date;  </div><div class="line">  </div><div class="line">import com.fasterxml.jackson.core.JsonGenerator;  </div><div class="line">import com.fasterxml.jackson.core.JsonProcessingException;  </div><div class="line">import com.fasterxml.jackson.databind.JsonSerializer;  </div><div class="line">import com.fasterxml.jackson.databind.SerializerProvider;  </div><div class="line">  </div><div class="line">/**  </div><div class="line"> * ClassName:DateJsonSerializer &lt;br/&gt;  </div><div class="line"> * Function: 日期类型格式化，格式化为：yyyy-MM-dd HH:mm:ss 格式. 用法如下：&lt;br/&gt;  </div><div class="line"> * Reason:   @JsonSerialize(using=DateJsonSerializer.class) </div><div class="line"> *           @Column(name=&quot;BIRTHDAY&quot;) </div><div class="line"> *           public Date getBirthday() &#123; </div><div class="line"> *              return birthday; </div><div class="line"> *           &#125; </div><div class="line"> *          . &lt;br/&gt;  </div><div class="line"> * Date:     2014年7月10日 下午1:26:08 &lt;br/&gt;  </div><div class="line"> * @author   zhangzhaoyu  </div><div class="line"> * @version   1.0 </div><div class="line"> * @since    JDK 1.7  </div><div class="line"> * @see        </div><div class="line"> */  </div><div class="line">public class DateJsonSerializer extends JsonSerializer&lt;Date&gt; &#123;  </div><div class="line">  </div><div class="line">    @Override  </div><div class="line">    public void serialize(Date value, JsonGenerator jgen,  </div><div class="line">            SerializerProvider provider) throws IOException,  </div><div class="line">            JsonProcessingException &#123;  </div><div class="line">         SimpleDateFormat formatter = new SimpleDateFormat(&quot;yyyy-MM-dd HH:mm:ss&quot;);  </div><div class="line">         String formattedDate = formatter.format(value);  </div><div class="line">         jgen.writeString(formattedDate);  </div><div class="line">    &#125;  </div><div class="line">  </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="方法三：jackson-注解处理"><a href="#方法三：jackson-注解处理" class="headerlink" title="方法三：jackson 注解处理"></a>方法三：jackson 注解处理</h3><p>@JsonIgnoreProperties<br>此注解是类注解，作用是json序列化时将javabean中的一些属性忽略掉，序列化和反序列化都受影响。  </p>
<p>@JsonIgnore<br>此注解用于属性或者方法上（最好是属性上），作用和上面的@JsonIgnoreProperties一样。  </p>
<p>@JsonFormat<br>此注解用于属性或者方法上（最好是属性上），可以方便的把Date类型直接转化为我们想要的模式，比如@JsonFormat(pattern = “yyyy-MM-dd HH-mm-ss”)  </p>
<p>@JsonSerialize  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"> // 反序列化一个固定格式的Date    </div><div class="line">    @JsonDeserialize(using = CustomDateDeserialize.class)    </div><div class="line">    public void setBirthday(Date birthday) &#123;    </div><div class="line">        this.birthday = birthday;    </div><div class="line">    &#125;   </div><div class="line">  </div><div class="line"> // 序列化指定格式的double格式    </div><div class="line">    @JsonSerialize(using = CustomDoubleSerialize.class)    </div><div class="line">    public double getSalary() &#123;    </div><div class="line">        return salary;    </div><div class="line">    &#125;    </div><div class="line">  </div><div class="line">public class CustomDateDeserialize extends JsonDeserializer&lt;Date&gt; &#123;    </div><div class="line">    </div><div class="line">    private SimpleDateFormat sdf = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;);    </div><div class="line">    </div><div class="line">    @Override    </div><div class="line">    public Date deserialize(JsonParser jp, DeserializationContext ctxt)    </div><div class="line">            throws IOException, JsonProcessingException &#123;    </div><div class="line">    </div><div class="line">        Date date = null;    </div><div class="line">        try &#123;    </div><div class="line">            date = sdf.parse(jp.getText());    </div><div class="line">        &#125; catch (ParseException e) &#123;    </div><div class="line">            e.printStackTrace();    </div><div class="line">        &#125;    </div><div class="line">        return date;    </div><div class="line">    &#125;    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/08/29/Json-jsonconfig/" itemprop="url">
                  JSON 中JsonConfig的使用
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-08-29T20:11:26+08:00" content="2015 年 08 月 29 日">
              2015 年 08 月 29 日
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/JSON/" itemprop="url" rel="index">
                    <span itemprop="name">JSON</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/08/29/Json-jsonconfig/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2015/08/29/Json-jsonconfig/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2015/08/29/Json-jsonconfig/" class="leancloud_visitors" data-flag-title="JSON 中JsonConfig的使用">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>我们通常对一个Json串和java对象进行互转时，经常会有选择性的过滤掉一些属性值，而json-lib包中的JsonConfig为我们提供了这种 功能，具体实现方法有以下几种。(1)建立JsonConfig实例，并配置属性排除列表,(2)用属性过滤器,(3)写一个自定义的 JsonBeanProcessor.</p>
<h3 id="1-实现JSONString接口的方法"><a href="#1-实现JSONString接口的方法" class="headerlink" title="1. 实现JSONString接口的方法"></a>1. 实现JSONString接口的方法</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">public class Person implements JSONString &#123;  </div><div class="line">private String name;  </div><div class="line">private String lastname;  </div><div class="line">private Address address;  </div><div class="line"></div><div class="line">// getters &amp; setters  </div><div class="line"></div><div class="line">public String toJSONString() &#123;</div><div class="line">return &quot;&#123;name:&apos;&quot;+name+&quot;&apos;,lastname:&apos;&quot;+lastname+&quot;&apos;&#125;&quot;;</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="2-第二种方法通过jsonconfig实例，对包含和需要排除的属性进行方便的添加或删除"><a href="#2-第二种方法通过jsonconfig实例，对包含和需要排除的属性进行方便的添加或删除" class="headerlink" title="2.第二种方法通过jsonconfig实例，对包含和需要排除的属性进行方便的添加或删除"></a>2.第二种方法通过jsonconfig实例，对包含和需要排除的属性进行方便的添加或删除</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">public class Person &#123;  </div><div class="line">    private String name;  </div><div class="line">    private String lastname;  </div><div class="line">    private Address address;  </div><div class="line">    // getters &amp; setters // </div><div class="line">&#125;  </div><div class="line"></div><div class="line">JsonConfig jsonConfig = new JsonConfig();  </div><div class="line">jsonConfig.setExclusions( new String[]&#123;&quot;address&quot;&#125;);  </div><div class="line">Person bean = new Person(&quot;jack&quot;,&quot;li&quot;);  </div><div class="line">JSON json = JSONSerializer.toJSON(bean, jsonConfig);</div></pre></td></tr></table></figure>
<h3 id="3-使用propertyFilter可以允许同时对需要排除的属性和类进行控制，这种控制还可以是双向的，也可以应用到json字符串到java对象"><a href="#3-使用propertyFilter可以允许同时对需要排除的属性和类进行控制，这种控制还可以是双向的，也可以应用到json字符串到java对象" class="headerlink" title="3. 使用propertyFilter可以允许同时对需要排除的属性和类进行控制，这种控制还可以是双向的，也可以应用到json字符串到java对象"></a>3. 使用propertyFilter可以允许同时对需要排除的属性和类进行控制，这种控制还可以是双向的，也可以应用到json字符串到java对象</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">public class Person &#123;  </div><div class="line">private String name;  </div><div class="line">private String lastname;  </div><div class="line">private Address address;  </div><div class="line"></div><div class="line">// getters &amp; setters  </div><div class="line">&#125;  </div><div class="line"></div><div class="line">JsonConfig jsonConfig = new JsonConfig();  </div><div class="line">jsonConfig.setJsonPropertyFilter( new PropertyFilter()&#123;  </div><div class="line"></div><div class="line">public boolean apply(Object source/* 属性的拥有者 */ , String name /*属性名字*/ , Object value/* 属性值 */ )&#123;  </div><div class="line">// return true to skip name  </div><div class="line">return source instanceof Person &amp;&amp; name.equals(&quot;address&quot;);  </div><div class="line">&#125;  </div><div class="line">&#125;);  </div><div class="line">Person bean = new Person(&quot;jack&quot;,&quot;li&quot;); </div><div class="line">JSON json = JSONSerializer.toJSON( bean, jsonConfig )</div></pre></td></tr></table></figure>
<h3 id="4-最后来看JsonBeanProcessor-这种方式和实现JsonString很类似，返回一个代表原来的domain类的合法JSONObject"><a href="#4-最后来看JsonBeanProcessor-这种方式和实现JsonString很类似，返回一个代表原来的domain类的合法JSONObject" class="headerlink" title="4. 最后来看JsonBeanProcessor,这种方式和实现JsonString很类似，返回一个代表原来的domain类的合法JSONObject"></a>4. 最后来看JsonBeanProcessor,这种方式和实现JsonString很类似，返回一个代表原来的domain类的合法JSONObject</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">public class Person &#123;  </div><div class="line">private String name;  </div><div class="line">private String lastname;  </div><div class="line">private Address address;  </div><div class="line"></div><div class="line">// getters &amp; setters  </div><div class="line">&#125;  </div><div class="line"></div><div class="line">JsonConfig jsonConfig = new JsonConfig();  </div><div class="line">jsonConfig.registerJsonBeanProcessor( Person.class, new JsonBeanProcessor()&#123;  </div><div class="line"></div><div class="line">public JSONObject processBean( Object bean, JsonConfig jsonConfig )&#123;  </div><div class="line">if(!(bean instanceof Person))&#123;  </div><div class="line">return new JSONObject(true);  </div><div class="line">&#125;  </div><div class="line">Person person = (Person) bean;  </div><div class="line">return new JSONObject() .element( &quot;name&quot;, person.getName()) .element( &quot;lastname&quot;, person.getLastname());  </div><div class="line">&#125;  </div><div class="line">&#125;);  </div><div class="line"></div><div class="line">Person bean = new Person(&quot;jack&quot;,&quot;li&quot;); </div><div class="line">JSON json = JSONSerializer.toJSON( bean, jsonConfig );</div></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/07/26/centos-install-mysql/" itemprop="url">
                  Centos6.4 用rpm方式安装MySql5.6
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-07-26T17:24:35+08:00" content="2015 年 07 月 26 日">
              2015 年 07 月 26 日
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/服务器/" itemprop="url" rel="index">
                    <span itemprop="name">服务器</span>
                  </a>
                </span>

                
                
                  ， 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/服务器/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/07/26/centos-install-mysql/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2015/07/26/centos-install-mysql/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2015/07/26/centos-install-mysql/" class="leancloud_visitors" data-flag-title="Centos6.4 用rpm方式安装MySql5.6">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Centos6-4-用rpm方式安装MySql5-6"><a href="#Centos6-4-用rpm方式安装MySql5-6" class="headerlink" title="Centos6.4 用rpm方式安装MySql5.6"></a>Centos6.4 用rpm方式安装MySql5.6</h1><h3 id="1-查看系统是否安装了MySQL"><a href="#1-查看系统是否安装了MySQL" class="headerlink" title="1. 查看系统是否安装了MySQL"></a>1. 查看系统是否安装了MySQL</h3><p>使用命令：</p>
<pre><code>#rpm -qa | grep mysql 
</code></pre><h3 id="2-卸载已安装的MySQL"><a href="#2-卸载已安装的MySQL" class="headerlink" title="2. 卸载已安装的MySQL"></a>2. 卸载已安装的MySQL</h3><p>卸载mysql命令如下： </p>
<pre><code>#rpm -e --nodeps  mysql-libs-5.1.61-4.el6.x86_64
</code></pre><p>要将 /var/lib/mysql文件夹下的所有文件都删除干净</p>
<h3 id="3-安装新的MySQL"><a href="#3-安装新的MySQL" class="headerlink" title="3. 安装新的MySQL"></a>3. 安装新的MySQL</h3><p>命令如下：</p>
<pre><code>#rpm -ivh MySQL-server-5.5.30-1.el6.x86_64.rpm

#rpm -ivh MySQL-client-5.5.30-1.el6.x86_64.rpm

#rpm -ivh MySQL-devel-5.5.30-1.el6.x86_64.rpm
</code></pre><h3 id="4-启动MySQL服务"><a href="#4-启动MySQL服务" class="headerlink" title="4. 启动MySQL服务"></a>4. 启动MySQL服务</h3><p>方法一：重新启动系统</p>
<p>方法二：#service mysql start</p>
<pre><code>查看MySQL运行状态的方法：


 使用命令：# /etc/rc.d/init.d/mysql status
 结果：   显示 “SUCCESS” 则已经运行
              显示 “FAILED”  则没有运行
</code></pre><h3 id="5-MySQL服务一些其他命令"><a href="#5-MySQL服务一些其他命令" class="headerlink" title="5. MySQL服务一些其他命令"></a>5. MySQL服务一些其他命令</h3><pre><code>a、察看mysql是否在自动启动列表：  #　/sbin/chkconfig –list
b、添加mysql到系统自启动服务组：  #　/sbin/chkconfig　– add　mysql
c、把mysql从启动服务组中删除：    #　/sbin/chkconfig　– del　mysql  
d、停止mysql服务：                #  service mysql stop
e、脚本启动mysql服务：            #  /etc/rc.d/init.d/mysqld start  
f、脚本停止mysql服务：            #  /etc/rc.d/init.d/mysqld stop
</code></pre><h3 id="6、安装完成之后为MySQL设置root密码。"><a href="#6、安装完成之后为MySQL设置root密码。" class="headerlink" title="6、安装完成之后为MySQL设置root密码。"></a>6、安装完成之后为MySQL设置root密码。</h3><p>命令如下：</p>
<pre><code># mysql -u root -p
</code></pre><p>会提示输入密码，初始root密码保存在’/root/.mysql_secret’文件中<br>接着输入</p>
<pre><code>mysql&gt;SET PASSWORD = PASSWORD(&apos;123456&apos;);
</code></pre><h3 id="7、mysql安装目录说明"><a href="#7、mysql安装目录说明" class="headerlink" title="7、mysql安装目录说明"></a>7、mysql安装目录说明</h3><pre><code>/var/lib/mysql          数据库文件
/usr/share/mysql        命令及配置文件
/usr/bin                (mysqladmin、mysqldump等命令)
</code></pre><h3 id="8、linux-下安装的mysql表名是区分大小写的，如果要不区分大小写，可以采用以下方式"><a href="#8、linux-下安装的mysql表名是区分大小写的，如果要不区分大小写，可以采用以下方式" class="headerlink" title="8、linux 下安装的mysql表名是区分大小写的，如果要不区分大小写，可以采用以下方式"></a>8、linux 下安装的mysql表名是区分大小写的，如果要不区分大小写，可以采用以下方式</h3><p>   1、拷贝 /usr/share/mysql/my-huge.cnf到/etc/my.cnf（如果已有该文件可以直接修改）</p>
<pre><code>    命令如下：

# cp /usr/share/mysql/my-huge.cnf  /etc/my.cnf
</code></pre><p>   2、修改my.cnf 文件<br>        在 [mysqld]下增加<br>        lower_case_table_names=1 #表名全部为小写，避免出现大小写敏感</p>
<p>   3、重启mysql</p>
<pre><code># service mysql restart
</code></pre><h3 id="9-可选-、为连接MySQL的主机分配权限："><a href="#9-可选-、为连接MySQL的主机分配权限：" class="headerlink" title="9(可选)、为连接MySQL的主机分配权限："></a>9(可选)、为连接MySQL的主机分配权限：</h3><p>   命令如下：</p>
<pre><code>&gt;mysql GRANT SELECT,INSERT,UPDATE,DELETE ON *.* TO root@xxx.xxx.x.xxidentified by &apos;123456&apos;; //xxx.xxx.x.xx是你的IP
</code></pre><h3 id="10、开机启动MySQL"><a href="#10、开机启动MySQL" class="headerlink" title="10、开机启动MySQL"></a>10、开机启动MySQL</h3><p>用root用户登录终端</p>
<p>查看是否已经有MySQL的服务</p>
<pre><code># chkconfig --list
</code></pre><p>如果没有MySQL(如果有请忽略这个步骤)</p>
<pre><code># chkconfig --add mysql
</code></pre><p>设置开机启动mysql服务</p>
<pre><code># chkconfig mysql on
</code></pre><h3 id="11-可选-、更改MySQL默认字符集-默认字符集和操作系统字符集一样，所以不需要设置"><a href="#11-可选-、更改MySQL默认字符集-默认字符集和操作系统字符集一样，所以不需要设置" class="headerlink" title="11(可选)、更改MySQL默认字符集 (默认字符集和操作系统字符集一样，所以不需要设置)"></a>11(可选)、更改MySQL默认字符集 (默认字符集和操作系统字符集一样，所以不需要设置)</h3><p>查看mysql字符集：</p>
<pre><code>mysql&gt; show variables like &apos;character_set_%&apos;;
</code></pre>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/03/12/maven-eclipse/" itemprop="url">
                  maven 不能设置为web3.0人解决方法
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-03-12T21:51:50+08:00" content="2015 年 03 月 12 日">
              2015 年 03 月 12 日
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/开发工具/" itemprop="url" rel="index">
                    <span itemprop="name">开发工具</span>
                  </a>
                </span>

                
                
                  ， 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/开发工具/Eclipse/" itemprop="url" rel="index">
                    <span itemprop="name">Eclipse</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/03/12/maven-eclipse/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2015/03/12/maven-eclipse/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2015/03/12/maven-eclipse/" class="leancloud_visitors" data-flag-title="maven 不能设置为web3.0人解决方法">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>错误： Description Resource Path Location Type Cannot change version of project facet Dynamic Web Module to 3.0.</p>
<p>以下是在GG搜索到的。<a href="http://stackoverflow.com/questions/75786/eclipse-how-can-i-change-a-project-facet-from-tomcat-6-to-tomcat-5-5" target="_blank" rel="external">http://stackoverflow.com/questions/75786/eclipse-how-can-i-change-a-project-facet-from-tomcat-6-to-tomcat-5-5</a></p>
<p>首先在硬盘下找到\项目名\setting\文件夹下的org.eclipse.wst.common.project.facet.core.xml  xml文件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</div><div class="line">&lt;faceted-project&gt;</div><div class="line">  &lt;fixed facet=&quot;wst.jsdt.web&quot;/&gt;</div><div class="line">  &lt;installed facet=&quot;jst.web&quot; version=&quot;2.3&quot;/&gt;</div><div class="line">  &lt;installed facet=&quot;wst.jsdt.web&quot; version=&quot;1.0&quot;/&gt;</div><div class="line">  &lt;installed facet=&quot;java&quot; version=&quot;1.7&quot;/&gt;</div><div class="line">&lt;/faceted-project&gt;</div></pre></td></tr></table></figure>
<p>将jst.web，的version改成3.0.<br>然后在eclipse里右键该工程–maven–updateProject即可。。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/taylor.png"
               alt="陈世强" />
          <p class="site-author-name" itemprop="name">陈世强</p>
          <p class="site-description motion-element" itemprop="description">你陪着我的时候，我从没有羡慕任何人。</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">11</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">13</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">12</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/chensian" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://blog.csdn.net/chen_shiqiang" target="_blank" title="CSDN">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  CSDN
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.zhihu.com/people/chesian" target="_blank" title="知乎">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  知乎
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              Links
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://macshuo.com/" title="MacTalk" target="_blank">MacTalk</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://example.com/" title="Title" target="_blank">Title</a>
                </li>
              
            </ul>
          </div>
        

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2015 - 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">陈世强</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.0.1"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"chesian"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
  





  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
       search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body").append('<div class="popoverlay">').css('overflow', 'hidden');
      $('.popup').toggle();

    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
    'use strict';
    $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
            // get the contents from search data
            isfetched = true;
            $('.popup').detach().appendTo('.header-inner');
            var datas = $( "entry", xmlResponse ).map(function() {
                return {
                    title: $( "title", this ).text(),
                    content: $("content",this).text(),
                    url: $( "url" , this).text()
                };
            }).get();
            var $input = document.getElementById(search_id);
            var $resultContent = document.getElementById(content_id);
            $input.addEventListener('input', function(){
                var matchcounts = 0;
                var str='<ul class=\"search-result-list\">';                
                var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                $resultContent.innerHTML = "";
                if (this.value.trim().length > 1) {
                // perform local searching
                datas.forEach(function(data) {
                    var isMatch = true;
                    var content_index = [];
                    var data_title = data.title.trim().toLowerCase();
                    var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                    var data_url = data.url;
                    var index_title = -1;
                    var index_content = -1;
                    var first_occur = -1;
                    // only match artiles with not empty titles and contents
                    if(data_title != '' && data_content != '') {
                        keywords.forEach(function(keyword, i) {
                            index_title = data_title.indexOf(keyword);
                            index_content = data_content.indexOf(keyword);
                            if( index_title < 0 && index_content < 0 ){
                                isMatch = false;
                            } else {
                                if (index_content < 0) {
                                    index_content = 0;
                                }
                                if (i == 0) {
                                    first_occur = index_content;
                                }
                            }
                        });
                    }
                    // show search results
                    if (isMatch) {
                        matchcounts += 1;
                        str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                        var content = data.content.trim().replace(/<[^>]+>/g,"");
                        if (first_occur >= 0) {
                            // cut out 100 characters
                            var start = first_occur - 20;
                            var end = first_occur + 80;
                            if(start < 0){
                                start = 0;
                            }
                            if(start == 0){
                                end = 50;
                            }
                            if(end > content.length){
                                end = content.length;
                            }
                            var match_content = content.substring(start, end);
                            // highlight all keywords
                            keywords.forEach(function(keyword){
                                var regS = new RegExp(keyword, "gi");
                                match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                            });
                            
                            str += "<p class=\"search-result\">" + match_content +"...</p>"
                        }
                        str += "</li>";
                    }
                })};
                str += "</ul>";
                if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
                if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
                $resultContent.innerHTML = str;
            });
            proceedsearch();
        }
    });}

    // handle and trigger popup window;
    $('.popup-trigger').mousedown(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };

    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".popoverlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>

  

  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("Gp631ljrulxxQsO3C8Cf53fk-gzGzoHsz", "Uo1Jv7vhPGFYFrDjc73yHa7P");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

</body>
</html>
