<!doctype html>



  


<html class="theme-next pisces use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  
    
      
    

    
  

  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Lobster Two:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="你陪着我的时候，我从没有羡慕任何人。">
<meta property="og:type" content="website">
<meta property="og:title" content="chesian">
<meta property="og:url" content="http://yoursite.com/page/3/index.html">
<meta property="og:site_name" content="chesian">
<meta property="og:description" content="你陪着我的时候，我从没有羡慕任何人。">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="chesian">
<meta name="twitter:description" content="你陪着我的时候，我从没有羡慕任何人。">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>

  <title> chesian </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  



  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?e3bc6c75aa4aaaa95ce188f16a662898";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>








  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">chesian</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="#" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup">
 <span class="search-icon fa fa-search"></span>
 <input type="text" id="local-search-input">
 <div id="local-search-result"></div>
 <span class="popup-btn-close">close</span>
</div>


    </div>
  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/09/04/hibernate-language/" itemprop="url">
                  Hibernate查询语言
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-09-04T10:12:26+08:00" content="2015 年 09 月 04 日">
              2015 年 09 月 04 日
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/JavaEE/" itemprop="url" rel="index">
                    <span itemprop="name">JavaEE</span>
                  </a>
                </span>

                
                
                  ， 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/JavaEE/Hibernate/" itemprop="url" rel="index">
                    <span itemprop="name">Hibernate</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/09/04/hibernate-language/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2015/09/04/hibernate-language/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2015/09/04/hibernate-language/" class="leancloud_visitors" data-flag-title="Hibernate查询语言">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>转载请注明出处，谢谢！（原文链接：<a href="https://chensian.github.io/2015/09/04/hibernate-language/" target="_blank" rel="external">https://chensian.github.io/2015/09/04/hibernate-language/</a> ）</p>
<h2 id="HQL-Hibernate查询语言"><a href="#HQL-Hibernate查询语言" class="headerlink" title="HQL: Hibernate查询语言"></a>HQL: Hibernate查询语言</h2><p>Hibernate配备了一种非常强大的查询语言，这种语言看上去很像SQL。但是不要被语法结构 上的相似所迷惑，HQL是非常有意识的被设计为完全面向对象的查询，它可以理解如继承、多态 和关联之类的概念。</p>
<p>Hibernate配备了一种非常强大的查询语言，这种语言看上去很像SQL。但是不要被语法结构 上的相似所迷惑，HQL是非常有意识的被设计为完全面向对象的查询，它可以理解如继承、多态 和关联之类的概念。</p>
<h3 id="1-大小写敏感性问题"><a href="#1-大小写敏感性问题" class="headerlink" title="1. 大小写敏感性问题"></a>1. 大小写敏感性问题</h3><p>除了Java类与属性的名称外，查询语句对大小写并不敏感。 所以 SeLeCT 与 sELEct 以及 SELECT 是相同的，但是 org.hibernate.eg.FOO 并不等价于org.hibernate.eg.Foo 并且 foo.barSet 也不等价于 foo.BARSET。<br>本手册中的HQL关键字将使用小写字母. 很多用户发现使用完全大写的关键字会使查询语句 的可读性更强, 但我们发现，当把查询语句嵌入到Java语句中的时候使用大写关键字比较难看。</p>
<h3 id="2-from子句"><a href="#2-from子句" class="headerlink" title="2. from子句"></a>2. from子句</h3><p>Hibernate中最简单的查询语句的形式如下：</p>
<pre><code>from eg.Cat
</code></pre><p>该子句简单的返回eg.Cat类的所有实例。 通常我们不需要使用类的全限定名, 因为 auto-import（自动引入） 是缺省的情况。 所以我们几乎只使用如下的简单写法：</p>
<pre><code>from Cat
</code></pre><p>大多数情况下, 你需要指定一个别名, 原因是你可能需要 在查询语句的其它部分引用到Cat</p>
<pre><code>from Cat as cat
</code></pre><p>这个语句把别名cat指定给类Cat 的实例, 这样我们就可以在随后的查询中使用此别名了。 关键字as 是可选的，我们也可以这样写:</p>
<pre><code>from Cat cat
</code></pre><p>子句中可以同时出现多个类, 其查询结果是产生一个笛卡儿积或产生跨表的连接。</p>
<pre><code>from Formula, Parameter
from Formula as form, Parameter as param
</code></pre><p>查询语句中别名的开头部分小写被认为是实践中的好习惯， 这样做与Java变量的命名标准保持了一致 (比如，domesticCat)。</p>
<h3 id="3-关联-Association-与连接-Join"><a href="#3-关联-Association-与连接-Join" class="headerlink" title="3. 关联(Association)与连接(Join)"></a>3. 关联(Association)与连接(Join)</h3><p>我们也可以为相关联的实体甚至是对一个集合中的全部元素指定一个别名, 这时要使用关键字join。</p>
<pre><code>from Cat as cat 
    inner join cat.mate as mate
    left outer join cat.kittens as kitten

from Cat as cat left join cat.mate.kittens as kittens
from Formula form full join form.parameter param
</code></pre><p>受支持的连接类型是从ANSI SQL中借鉴来的。</p>
<ul>
<li>inner join（内连接）</li>
<li>left outer join（左外连接）</li>
<li>right outer join（右外连接）</li>
<li>full join (全连接，并不常用)</li>
</ul>
<p>语句inner join, left outer join 以及 right outer join 可以简写。</p>
<pre><code>from Cat as cat 
    join cat.mate as mate
    left join cat.kittens as kitten
</code></pre><p>还有，一个”fetch”连接允许仅仅使用一个选择语句就将相关联的对象或一组值的集合随着他们的父对象的初始化而被初始化，这种方法在使用到集合的情况下尤其有用，对于关联和集合来说，它有效的代替了映射文件中的外联接 与延迟声明（lazy declarations）. </p>
<pre><code>from Cat as cat 
    inner join fetch cat.mate
    left join fetch cat.kittens
</code></pre><p>一个fetch连接通常不需要被指定别名, 因为相关联的对象不应当被用在 where 子句 (或其它任何子句)中。同时，相关联的对象并不在查询的结果中直接返回，但可以通过他们的父对象来访问到他们。</p>
<p>注意fetch构造变量在使用了scroll() 或 iterate()函数的查询中是不能使用的。最后注意，使用full join fetch 与 right join fetch是没有意义的。</p>
<p>如果你使用属性级别的延迟获取（lazy fetching）（这是通过重新编写字节码实现的），可以使用 fetch all properties 来强制Hibernate立即取得那些原本需要延迟加载的属性（在第一个查询中）。</p>
<pre><code>from Document fetch all properties order by name
from Document doc fetch all properties where lower(doc.name) like &apos;%cats%&apos;
</code></pre><h3 id="4-select子句"><a href="#4-select子句" class="headerlink" title="4. select子句"></a>4. select子句</h3><p>select 子句选择将哪些对象与属性返 回到查询结果集中. 考虑如下情况:</p>
<pre><code>select mate 
from Cat as cat 
    inner join cat.mate as mate
</code></pre><p>该语句将选择mates of other Cats。（其他猫的配偶） 实际上, 你可以更简洁的用以下的查询语句表达相同的含义:</p>
<pre><code>select cat.mate from Cat cat
</code></pre><p>查询语句可以返回值为任何类型的属性，包括返回类型为某种组件(Component)的属性:</p>
<pre><code>select cat.name from DomesticCat cat
where cat.name like &apos;fri%&apos;
select cust.name.firstName from Customer as cust
</code></pre><p>查询语句可以返回多个对象和（或）属性，存放在 Object[]队列中,</p>
<pre><code>select mother, offspr, mate.name 
from DomesticCat as mother
    inner join mother.mate as mate
    left outer join mother.kittens as offspr
</code></pre><p>或存放在一个List对象中,</p>
<pre><code>select new list(mother, offspr, mate.name)
from DomesticCat as mother
    inner join mother.mate as mate
    left outer join mother.kittens as offspr
</code></pre><p>也可能直接返回一个实际的类型安全的Java对象,</p>
<pre><code>select new Family(mother, mate, offspr)
from DomesticCat as mother
    join mother.mate as mate
    left join mother.kittens as offspr
</code></pre><p>假设类Family有一个合适的构造函数.<br>你可以使用关键字as给“被选择了的表达式”指派别名:</p>
<pre><code>select max(bodyWeight) as max, min(bodyWeight) as min, count(*) as n
from Cat cat
</code></pre><p>这种做法在与子句select new map一起使用时最有用:</p>
<pre><code>select new map( max(bodyWeight) as max, min(bodyWeight) as min, count(*) as n )
from Cat cat
</code></pre><p>该查询返回了一个Map的对象，内容是别名与被选择的值组成的名-值映射。</p>
<h3 id="5-聚集函数"><a href="#5-聚集函数" class="headerlink" title="5. 聚集函数"></a>5. 聚集函数</h3><p>HQL查询甚至可以返回作用于属性之上的聚集函数的计算结果:</p>
<pre><code>select avg(cat.weight), sum(cat.weight), max(cat.weight), count(cat)
from Cat cat
</code></pre><p>受支持的聚集函数如下：<br>avg(…), sum(…), min(…), max(…)<br>count(*)<br>count(…), count(distinct …), count(all…)</p>
<p>你可以在选择子句中使用数学操作符、连接以及经过验证的SQL函数：</p>
<pre><code>select cat.weight + sum(kitten.weight) 
from Cat cat 
    join cat.kittens kitten
group by cat.id, cat.weight
select firstName||&apos; &apos;||initial||&apos; &apos;||upper(lastName) from Person
</code></pre><p>关键字distinct与all 也可以使用，它们具有与SQL相同的语义.</p>
<pre><code>select distinct cat.name from Cat cat

select count(distinct cat.name), count(cat) from Cat cat
</code></pre><h3 id="6-多态查询"><a href="#6-多态查询" class="headerlink" title="6. 多态查询"></a>6. 多态查询</h3><p>一个如下的查询语句:</p>
<pre><code>from Cat as cat
</code></pre><p>不仅返回Cat类的实例, 也同时返回子类 DomesticCat的实例. Hibernate 可以在from子句中指定任何 Java 类或接口. 查询会返回继承了该类的所有持久化子类 的实例或返回声明了该接口的所有持久化类的实例。下面的查询语句返回所有的被持久化的对象：</p>
<pre><code>from java.lang.Object o
</code></pre><p>接口Named 可能被各种各样的持久化类声明：</p>
<pre><code>from Named n, Named m where n.name = m.name
</code></pre><p>注意，最后的两个查询将需要超过一个的SQL SELECT.这表明order by子句 没有对整个结果集进行正确的排序. (这也说明你不能对这样的查询使用Query.scroll()方法.)</p>
<h3 id="7-where子句"><a href="#7-where子句" class="headerlink" title="7. where子句"></a>7. where子句</h3><p>where子句允许你将返回的实例列表的范围缩小. 如果没有指定别名，你可以使用属性名来直接引用属性:</p>
<pre><code>from Cat where name=&apos;Fritz&apos;
</code></pre><p>如果指派了别名，需要使用完整的属性名:</p>
<pre><code>from Cat as cat where cat.name=&apos;Fritz&apos;
</code></pre><p>返回名为（属性name等于）’Fritz’的Cat类的实例。</p>
<pre><code>select foo 
from Foo foo, Bar bar
where foo.startDate = bar.date
</code></pre><p>将返回所有满足下面条件的Foo类的实例： 存在如下的bar的一个实例，其date属性等于 Foo的startDate属性。 复合路径表达式使得where子句非常的强大，考虑如下情况：</p>
<pre><code>from Cat cat where cat.mate.name is not null
</code></pre><p>该查询将被翻译成为一个含有表连接（内连接）的SQL查询。如果你打算写像这样的查询语句</p>
<pre><code>from Foo foo  
where foo.bar.baz.customer.address.city is not null
</code></pre><p>在SQL中，你为达此目的将需要进行一个四表连接的查询。<br>=运算符不仅可以被用来比较属性的值，也可以用来比较实例：</p>
<pre><code>from Cat cat, Cat rival where cat.mate = rival.mate
select cat, mate 
from Cat cat, Cat mate
where cat.mate = mate
</code></pre><p>特殊属性（小写）id可以用来表示一个对象的唯一的标识符。（你也可以使用该对象的属性名。）</p>
<pre><code>from Cat as cat where cat.id = 123

from Cat as cat where cat.mate.id = 69
</code></pre><p>第二个查询是有效的。此时不需要进行表连接！<br>同样也可以使用复合标识符。比如Person类有一个复合标识符，它由country属性 与medicareNumber属性组成。</p>
<pre><code>from bank.Person person
where person.id.country = &apos;AU&apos; 
    and person.id.medicareNumber = 123456
from bank.Account account
where account.owner.id.country = &apos;AU&apos; 
    and account.owner.id.medicareNumber = 123456
</code></pre><p>第二个查询也不需要进行表连接。<br>同样的，特殊属性class在进行多态持久化的情况下被用来存取一个实例的鉴别值（discriminator value）。 一个嵌入到where子句中的Java类的名字将被转换为该类的鉴别值。</p>
<pre><code>from Cat cat where cat.class = DomesticCat
</code></pre><p>你也可以声明一个属性的类型是组件或者复合用户类型（以及由组件构成的组件等等）。永远不要尝试使用以组件类型来结尾的路径表达式（path-expression） （与此相反，你应当使用组件的一个属性来结尾）。 </p>
<p>举例来说，如果store.owner含有一个包含了组件的实体address<br>store.owner.address.city    // 正确<br>store.owner.address         // 错误!<br>一个“任意”类型有两个特殊的属性id和class, 来允许我们按照下面的方式表达一个连接（AuditLog.item 是一个属性，该属性被映射为<any>）。</any></p>
<pre><code>from AuditLog log, Payment payment 
where log.item.class = &apos;Payment&apos; and log.item.id = payment.id
</code></pre><p>注意，在上面的查询与句中，log.item.class 和 payment.class 将涉及到完全不同的数据库中的列。</p>
<h3 id="8-表达式"><a href="#8-表达式" class="headerlink" title="8. 表达式"></a>8. 表达式</h3><p>在where子句中允许使用的表达式包括 大多数你可以在SQL使用的表达式种类:</p>
<p>数学运算符+, -, *, /<br>二进制比较运算符=, &gt;=, &lt;=, &lt;&gt;, !=, like<br>逻辑运算符and, or, not<br>in, not in, between, is null, is not null, is empty, is not empty, member of and not member of<br>“简单的” case, case … when … then … else … end,和 “搜索” case, case when … then … else … end<br>字符串连接符…||… or concat(…,…)<br>current_date(), current_time(), current_timestamp()<br>second(…), minute(…), hour(…), day(…), month(…), year(…),<br>EJB-QL 3.0定义的任何函数或操作：substring(), trim(), lower(), upper(), length(), locate(), abs(), sqrt(), bit_length()<br>coalesce() 和 nullif()<br>cast(… as …), 其第二个参数是某Hibernate类型的名字，以及extract(… from …)，只要ANSI cast() 和 extract() 被底层数据库支持<br>任何数据库支持的SQL标量函数，比如sign(), trunc(), rtrim(), sin()</p>
<p>JDBC参数传入 ?<br>命名参数:name, :start_date, :x1<br>SQL 直接常量 ‘foo’, 69, ‘1970-01-01 10:00:01.0’<br>Java public static final 类型的常量 eg.Color.TABBY</p>
<p>关键字in与between可按如下方法使用:</p>
<pre><code>from DomesticCat cat where cat.name between &apos;A&apos; and &apos;B&apos;
from DomesticCat cat where cat.name in ( &apos;Foo&apos;, &apos;Bar&apos;, &apos;Baz&apos; )
</code></pre><p>而且否定的格式也可以如下书写：</p>
<pre><code>from DomesticCat cat where cat.name not between &apos;A&apos; and &apos;B&apos;
from DomesticCat cat where cat.name not in ( &apos;Foo&apos;, &apos;Bar&apos;, &apos;Baz&apos; )
</code></pre><p>同样, 子句is null与is not null可以被用来测试空值(null).<br>在Hibernate配置文件中声明HQL“查询替代（query substitutions）”之后， 布尔表达式（Booleans）可以在其他表达式中轻松的使用:</p>
<pre><code>&lt;property name=&quot;hibernate.query.substitutions&quot;&gt;true 1, false 0&lt;/property&gt;
</code></pre><p>系统将该HQL转换为SQL语句时，该设置表明将用字符 1 和 0 来 取代关键字true 和 </p>
<pre><code>false:
from Cat cat where cat.alive = true
</code></pre><p>你可以用特殊属性size, 或是特殊函数size()测试一个集合的大小。</p>
<pre><code>from Cat cat where cat.kittens.size &gt; 0
from Cat cat where size(cat.kittens) &gt; 0
</code></pre><p>对于索引了（有序）的集合，你可以使用minindex 与 maxindex函数来引用到最小与最大的索引序数。 同理，你可以使用minelement 与 maxelement函数来 引用到一个基本数据类型的集合中最小与最大的元素。</p>
<pre><code>from Calendar cal where maxelement(cal.holidays) &gt; current date
from Order order where maxindex(order.items) &gt; 100
from Order order where minelement(order.items) &gt; 10000
</code></pre><p>在传递一个集合的索引集或者是元素集(elements与indices 函数) 或者传递一个子查询的结果的时候，可以使用SQL函数any, some, all, exists, in</p>
<pre><code>select mother from Cat as mother, Cat as kit
where kit in elements(foo.kittens)
select p from NameList list, Person p
where p.name = some elements(list.names)
from Cat cat where exists elements(cat.kittens)
from Player p where 3 &gt; all elements(p.scores)
from Show show where &apos;fizard&apos; in indices(show.acts)
</code></pre><p>注意，在Hibernate3种，这些结构变量- size, elements, indices, minindex, maxindex, minelement, maxelement - 只能在where子句中使用。<br>一个被索引过的（有序的）集合的元素(arrays, lists, maps)可以在其他索引中被引用（只能在where子句中）：</p>
<pre><code>from Order order where order.items[0].id = 1234
select person from Person person, Calendar calendar
where calendar.holidays[&apos;national day&apos;] = person.birthDay
    and person.nationality.calendar = calendar
select item from Item item, Order order
where order.items[ order.deliveredItemIndices[0] ] = item and order.id = 11
select item from Item item, Order order
where order.items[ maxindex(order.items) ] = item and order.id = 11
</code></pre><p>在[]中的表达式甚至可以是一个算数表达式。</p>
<pre><code>select item from Item item, Order order
where order.items[ size(order.items) - 1 ] = item
</code></pre><p>对于一个一对多的关联（one-to-many association）或是值的集合中的元素， HQL也提供内建的index()函数，</p>
<pre><code>select item, index(item) from Order order 
    join order.items item
where index(item) &lt; 5
</code></pre><p>如果底层数据库支持标量的SQL函数，它们也可以被使用</p>
<pre><code>from DomesticCat cat where upper(cat.name) like &apos;FRI%&apos;
</code></pre><p>如果你还不能对所有的这些深信不疑，想想下面的查询。如果使用SQL，语句长度会增长多少，可读性会下降多少：</p>
<pre><code>select cust
from Product prod,
    Store store
    inner join store.customers cust
where prod.name = &apos;widget&apos;
    and store.location.name in ( &apos;Melbourne&apos;, &apos;Sydney&apos; )
    and prod = all elements(cust.currentOrder.lineItems)
</code></pre><p>提示: 会像如下的语句</p>
<pre><code>SELECT cust.name, cust.address, cust.phone, cust.id, cust.current_order
FROM customers cust,
    stores store,
    locations loc,
    store_customers sc,
    product prod
WHERE prod.name = &apos;widget&apos;
    AND store.loc_id = loc.id
    AND loc.name IN ( &apos;Melbourne&apos;, &apos;Sydney&apos; )
    AND sc.store_id = store.id
    AND sc.cust_id = cust.id
    AND prod.id = ALL(
        SELECT item.prod_id
        FROM line_items item, orders o
        WHERE item.order_id = o.id
            AND cust.current_order = o.id
    )
</code></pre><h3 id="9-order-by子句"><a href="#9-order-by子句" class="headerlink" title="9. order by子句"></a>9. order by子句</h3><p>查询返回的列表(list)可以按照一个返回的类或组件（components)中的任何属性（property）进行排序：</p>
<pre><code>from DomesticCat cat
order by cat.name asc, cat.weight desc, cat.birthdate
</code></pre><p>可选的asc或desc关键字指明了按照升序或降序进行排序.</p>
<h3 id="10-group-by子句"><a href="#10-group-by子句" class="headerlink" title="10. group by子句"></a>10. group by子句</h3><p>一个返回聚集值(aggregate values)的查询可以按照一个返回的类或组件（components)中的任何属性（property）进行分组：</p>
<pre><code>select cat.color, sum(cat.weight), count(cat) 
from Cat cat
group by cat.color
select foo.id, avg(name), max(name) 
from Foo foo join foo.names name
group by foo.id
</code></pre><p>having子句在这里也允许使用.</p>
<pre><code>select cat.color, sum(cat.weight), count(cat) 
from Cat cat
group by cat.color 
having cat.color in (eg.Color.TABBY, eg.Color.BLACK)
</code></pre><p>如果底层的数据库支持的话(例如不能在MySQL中使用)，SQL的一般函数与聚集函数也可以出现 在having与order by 子句中。</p>
<pre><code>select cat
from Cat cat
    join cat.kittens kitten
group by cat
having avg(kitten.weight) &gt; 100
order by count(kitten) asc, sum(kitten.weight) desc
</code></pre><p>注意group by子句与 order by子句中都不能包含算术表达式（arithmetic expressions）.</p>
<h3 id="11-子查询"><a href="#11-子查询" class="headerlink" title="11. 子查询"></a>11. 子查询</h3><p>对于支持子查询的数据库，Hibernate支持在查询中使用子查询。一个子查询必须被圆括号包围起来（经常是SQL聚集函数的圆括号）。 甚至相互关联的子查询（引用到外部查询中的别名的子查询）也是允许的。</p>
<pre><code>from Cat as fatcat 
where fatcat.weight &gt; ( 
    select avg(cat.weight) from DomesticCat cat 
)
from DomesticCat as cat 
where cat.name = some ( 
    select name.nickName from Name as name 
)
from Cat as cat 
where not exists ( 
    from Cat as mate where mate.mate = cat 
)
from DomesticCat as cat 
where cat.name not in ( 
    select name.nickName from Name as name 
)
</code></pre><p>在select列表中包含一个表达式以上的子查询，你可以使用一个元组构造符（tuple constructors）：</p>
<pre><code>from Cat as cat 
where not ( cat.name, cat.color ) in ( 
    select cat.name, cat.color from DomesticCat cat 
)
</code></pre><p>注意在某些数据库中（不包括Oracle与HSQL），你也可以在其他语境中使用元组构造符， 比如查询用户类型的组件与组合：</p>
<pre><code>from Person where name = (&apos;Gavin&apos;, &apos;A&apos;, &apos;King&apos;)
</code></pre><p>该查询等价于更复杂的：</p>
<pre><code>from Person where name.first = &apos;Gavin&apos; and name.initial = &apos;A&apos; and name.last = &apos;King&apos;)
</code></pre><p>有两个很好的理由使你不应当作这样的事情：首先，它不完全适用于各个数据库平台；其次，查询现在依赖于映射文件中属性的顺序。</p>
<h3 id="12-HQL示例"><a href="#12-HQL示例" class="headerlink" title="12. HQL示例"></a>12. HQL示例</h3><p>Hibernate查询可以非常的强大与复杂。实际上，Hibernate的一个主要卖点就是查询语句的威力。这里有一些例子，它们与我在最近的 一个项目中使用的查询非常相似。注意你能用到的大多数查询比这些要简单的多！<br>下面的查询对于某个特定的客户的所有未支付的账单，在给定给最小总价值的情况下，返回订单的id，条目的数量和总价值， 返回值按照总价值的结果进行排序。为了决定价格，查询使用了当前目录。作为转换结果的SQL查询，使用了ORDER, ORDER_LINE, PRODUCT, CATALOG 和PRICE 库表。</p>
<pre><code>select order.id, sum(price.amount), count(item)
from Order as order
    join order.lineItems as item
    join item.product as product,
    Catalog as catalog
    join catalog.prices as price
where order.paid = false
    and order.customer = :customer
    and price.product = product
    and catalog.effectiveDate &lt; sysdate
    and catalog.effectiveDate &gt;= all (
        select cat.effectiveDate 
        from Catalog as cat
        where cat.effectiveDate &lt; sysdate
    )
group by order
having sum(price.amount) &gt; :minAmount
order by sum(price.amount) desc
</code></pre><p>这简直是一个怪物！实际上，在现实生活中，我并不热衷于子查询，所以我的查询语句看起来更像这个：</p>
<pre><code>select order.id, sum(price.amount), count(item)
from Order as order
    join order.lineItems as item
    join item.product as product,
    Catalog as catalog
    join catalog.prices as price
where order.paid = false
    and order.customer = :customer
    and price.product = product
    and catalog = :currentCatalog
group by order
having sum(price.amount) &gt; :minAmount
order by sum(price.amount) desc
</code></pre><p>下面一个查询计算每一种状态下的支付的数目，除去所有处于AWAITING_APPROVAL状态的支付，因为在该状态下 当前的用户作出了状态的最新改变。该查询被转换成含有两个内连接以及一个相关联的子选择的SQL查询，该查询使用了表 PAYMENT, PAYMENT_STATUS 以及 PAYMENT_STATUS_CHANGE。</p>
<pre><code>select count(payment), status.name 
from Payment as payment 
    join payment.currentStatus as status
    join payment.statusChanges as statusChange
where payment.status.name &lt;&gt; PaymentStatus.AWAITING_APPROVAL
    or (
        statusChange.timeStamp = ( 
            select max(change.timeStamp) 
            from PaymentStatusChange change 
            where change.payment = payment
        )
        and statusChange.user &lt;&gt; :currentUser
    )
group by status.name, status.sortOrder
order by status.sortOrder
</code></pre><p>如果我把statusChanges实例集映射为一个列表（list）而不是一个集合（set）, 书写查询语句将更加简单.</p>
<pre><code>select count(payment), status.name 
from Payment as payment
    join payment.currentStatus as status
where payment.status.name &lt;&gt; PaymentStatus.AWAITING_APPROVAL
    or payment.statusChanges[ maxIndex(payment.statusChanges) ].user &lt;&gt; :currentUser
group by status.name, status.sortOrder
order by status.sortOrder
</code></pre><p>下面一个查询使用了MS SQL Server的 isNull()函数用以返回当前用户所属组织的组织帐号及组织未支付的账。 它被转换成一个对表ACCOUNT,PAYMENT, PAYMENT_STATUS, ACCOUNT_TYPE, ORGANIZATION 以及 ORG_USER进行的三个内连接， 一个外连接和一个子选择的SQL查询。</p>
<pre><code>select account, payment
from Account as account
    left outer join account.payments as payment
where :currentUser in elements(account.holder.users)
    and PaymentStatus.UNPAID = isNull(payment.currentStatus.name, PaymentStatus.UNPAID)
order by account.type.sortOrder, account.accountNumber, payment.dueDate
</code></pre><p>对于一些数据库，我们需要弃用（相关的）子选择。</p>
<pre><code>select account, payment
from Account as account
    join account.holder.users as user
    left outer join account.payments as payment
where :currentUser = user
    and PaymentStatus.UNPAID = isNull(payment.currentStatus.name, PaymentStatus.UNPAID)
order by account.type.sortOrder, account.accountNumber, payment.dueDate
</code></pre><h3 id="13-批量的UPDATE-amp-DELETE语句"><a href="#13-批量的UPDATE-amp-DELETE语句" class="headerlink" title="13. 批量的UPDATE &amp; DELETE语句"></a>13. 批量的UPDATE &amp; DELETE语句</h3><p>HQL现在支持UPDATE与DELETE语句. 查阅 第 14.3 节 “大批量更新/删除（Bulk update/delete）” 以获得更多信息。</p>
<h3 id="14-小技巧-amp-小窍门"><a href="#14-小技巧-amp-小窍门" class="headerlink" title="14. 小技巧 &amp; 小窍门"></a>14. 小技巧 &amp; 小窍门</h3><p>你可以统计查询结果的数目而不必实际的返回他们：<br>( (Integer) session.iterate(“select count(*) from ….”).next() ).intValue()<br>若想根据一个集合的大小来进行排序，可以使用如下的语句：</p>
<pre><code>select usr.id, usr.name
from User as usr 
    left join usr.messages as msg
group by usr.id, usr.name
order by count(msg)
</code></pre><p>如果你的数据库支持子选择，你可以在你的查询的where子句中为选择的大小（selection size）指定一个条件:</p>
<pre><code>from User usr where size(usr.messages) &gt;= 1
</code></pre><p>如果你的数据库不支持子选择语句，使用下面的查询：</p>
<pre><code>select usr.id, usr.name
from User usr.name
    join usr.messages msg
group by usr.id, usr.name
having count(msg) &gt;= 1
</code></pre><p>因为内连接（inner join）的原因，这个解决方案不能返回含有零个信息的User 类的实例, 所以这种情况下使用下面的格式将是有帮助的:</p>
<pre><code>select usr.id, usr.name
from User as usr
    left join usr.messages as msg
group by usr.id, usr.name
having count(msg) = 0
</code></pre><p>JavaBean的属性可以被绑定到一个命名查询（named query）的参数上：</p>
<pre><code>Query q = s.createQuery(&quot;from foo Foo as foo where foo.name=:name and foo.size=:size&quot;);
q.setProperties(fooBean); // fooBean包含方法getName()与getSize()
List foos = q.list();
</code></pre><p>通过将接口Query与一个过滤器（filter）一起使用，集合（Collections）是可以分页的：</p>
<pre><code>Query q = s.createFilter( collection, &quot;&quot; ); // 一个简单的过滤器
q.setMaxResults(PAGE_SIZE);
q.setFirstResult(PAGE_SIZE * pageNumber);
List page = q.list();
</code></pre><p>通过使用查询过滤器（query filter）可以将集合（Collection）的原素分组或排序:</p>
<pre><code>Collection orderedCollection = s.filter( collection, &quot;order by this.amount&quot; );
Collection counts = s.filter( collection, &quot;select this.type, count(this) group by this.type&quot; );
</code></pre><p>不用通过初始化，你就可以知道一个集合（Collection）的大小：</p>
<pre><code>( (Integer) session.iterate(&quot;select count(*) from ....&quot;).next() ).intValue();
</code></pre>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/08/29/springmvc4-date-json/" itemprop="url">
                  springmvc4 date 日期类型处理 json
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-08-29T22:20:55+08:00" content="2015 年 08 月 29 日">
              2015 年 08 月 29 日
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/JavaEE/" itemprop="url" rel="index">
                    <span itemprop="name">JavaEE</span>
                  </a>
                </span>

                
                
                  ， 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/JavaEE/Springmvc/" itemprop="url" rel="index">
                    <span itemprop="name">Springmvc</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/08/29/springmvc4-date-json/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2015/08/29/springmvc4-date-json/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2015/08/29/springmvc4-date-json/" class="leancloud_visitors" data-flag-title="springmvc4 date 日期类型处理 json">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>转载请注明出处，谢谢！（原文链接：<a href="https://chensian.github.io/2015/08/29/springmvc4-date-json/" target="_blank" rel="external">https://chensian.github.io/2015/08/29/springmvc4-date-json/</a> ）</p>
<h3 id="1、方法一：全局处理"><a href="#1、方法一：全局处理" class="headerlink" title="1、方法一：全局处理"></a>1、方法一：全局处理</h3><pre><code>&lt;mvc:annotation-driven&gt;  
    &lt;!-- 处理responseBody 里面日期类型 --&gt;  
        &lt;mvc:message-converters&gt;  
            &lt;bean class=&quot;org.springframework.http.converter.json.MappingJackson2HttpMessageConverter&quot;&gt;  
                &lt;property name=&quot;objectMapper&quot;&gt;  
                    &lt;bean class=&quot;com.fasterxml.jackson.databind.ObjectMapper&quot;&gt;  
                        &lt;property name=&quot;dateFormat&quot;&gt;  
                            &lt;bean class=&quot;java.text.SimpleDateFormat&quot;&gt;  
                                &lt;constructor-arg type=&quot;java.lang.String&quot; value=&quot;yyyy-MM-dd HH:mm:ss&quot; /&gt;  
                            &lt;/bean&gt;  
                        &lt;/property&gt;  
                    &lt;/bean&gt;  
                &lt;/property&gt;  
            &lt;/bean&gt;  
        &lt;/mvc:message-converters&gt;  
    &lt;/mvc:annotation-driven&gt;  
</code></pre><h3 id="方法二：局部注解处理"><a href="#方法二：局部注解处理" class="headerlink" title="方法二：局部注解处理"></a>方法二：局部注解处理</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line">import java.io.IOException;  </div><div class="line">import java.text.SimpleDateFormat;  </div><div class="line">import java.util.Date;  </div><div class="line">  </div><div class="line">import com.fasterxml.jackson.core.JsonGenerator;  </div><div class="line">import com.fasterxml.jackson.core.JsonProcessingException;  </div><div class="line">import com.fasterxml.jackson.databind.JsonSerializer;  </div><div class="line">import com.fasterxml.jackson.databind.SerializerProvider;  </div><div class="line">  </div><div class="line">/**  </div><div class="line"> * ClassName:DateJsonSerializer &lt;br/&gt;  </div><div class="line"> * Function: 日期类型格式化，格式化为：yyyy-MM-dd HH:mm:ss 格式. 用法如下：&lt;br/&gt;  </div><div class="line"> * Reason:   @JsonSerialize(using=DateJsonSerializer.class) </div><div class="line"> *           @Column(name=&quot;BIRTHDAY&quot;) </div><div class="line"> *           public Date getBirthday() &#123; </div><div class="line"> *              return birthday; </div><div class="line"> *           &#125; </div><div class="line"> *          . &lt;br/&gt;  </div><div class="line"> * Date:     2014年7月10日 下午1:26:08 &lt;br/&gt;  </div><div class="line"> * @author   zhangzhaoyu  </div><div class="line"> * @version   1.0 </div><div class="line"> * @since    JDK 1.7  </div><div class="line"> * @see        </div><div class="line"> */  </div><div class="line">public class DateJsonSerializer extends JsonSerializer&lt;Date&gt; &#123;  </div><div class="line">  </div><div class="line">    @Override  </div><div class="line">    public void serialize(Date value, JsonGenerator jgen,  </div><div class="line">            SerializerProvider provider) throws IOException,  </div><div class="line">            JsonProcessingException &#123;  </div><div class="line">         SimpleDateFormat formatter = new SimpleDateFormat(&quot;yyyy-MM-dd HH:mm:ss&quot;);  </div><div class="line">         String formattedDate = formatter.format(value);  </div><div class="line">         jgen.writeString(formattedDate);  </div><div class="line">    &#125;  </div><div class="line">  </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="方法三：jackson-注解处理"><a href="#方法三：jackson-注解处理" class="headerlink" title="方法三：jackson 注解处理"></a>方法三：jackson 注解处理</h3><p>@JsonIgnoreProperties<br>此注解是类注解，作用是json序列化时将javabean中的一些属性忽略掉，序列化和反序列化都受影响。  </p>
<p>@JsonIgnore<br>此注解用于属性或者方法上（最好是属性上），作用和上面的@JsonIgnoreProperties一样。  </p>
<p>@JsonFormat<br>此注解用于属性或者方法上（最好是属性上），可以方便的把Date类型直接转化为我们想要的模式，比如@JsonFormat(pattern = “yyyy-MM-dd HH-mm-ss”)  </p>
<p>@JsonSerialize  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"> // 反序列化一个固定格式的Date    </div><div class="line">    @JsonDeserialize(using = CustomDateDeserialize.class)    </div><div class="line">    public void setBirthday(Date birthday) &#123;    </div><div class="line">        this.birthday = birthday;    </div><div class="line">    &#125;   </div><div class="line">  </div><div class="line"> // 序列化指定格式的double格式    </div><div class="line">    @JsonSerialize(using = CustomDoubleSerialize.class)    </div><div class="line">    public double getSalary() &#123;    </div><div class="line">        return salary;    </div><div class="line">    &#125;    </div><div class="line">  </div><div class="line">public class CustomDateDeserialize extends JsonDeserializer&lt;Date&gt; &#123;    </div><div class="line">    </div><div class="line">    private SimpleDateFormat sdf = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;);    </div><div class="line">    </div><div class="line">    @Override    </div><div class="line">    public Date deserialize(JsonParser jp, DeserializationContext ctxt)    </div><div class="line">            throws IOException, JsonProcessingException &#123;    </div><div class="line">    </div><div class="line">        Date date = null;    </div><div class="line">        try &#123;    </div><div class="line">            date = sdf.parse(jp.getText());    </div><div class="line">        &#125; catch (ParseException e) &#123;    </div><div class="line">            e.printStackTrace();    </div><div class="line">        &#125;    </div><div class="line">        return date;    </div><div class="line">    &#125;    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/08/29/Json-jsonconfig/" itemprop="url">
                  JSON 中JsonConfig的使用
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-08-29T20:11:26+08:00" content="2015 年 08 月 29 日">
              2015 年 08 月 29 日
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/JSON/" itemprop="url" rel="index">
                    <span itemprop="name">JSON</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/08/29/Json-jsonconfig/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2015/08/29/Json-jsonconfig/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2015/08/29/Json-jsonconfig/" class="leancloud_visitors" data-flag-title="JSON 中JsonConfig的使用">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>转载请注明出处，谢谢！（原文链接：<a href="https://chensian.github.io/2015/08/29/Json-jsonconfig/" target="_blank" rel="external">https://chensian.github.io/2015/08/29/Json-jsonconfig/</a> ）</p>
<p>我们通常对一个Json串和java对象进行互转时，经常会有选择性的过滤掉一些属性值，而json-lib包中的JsonConfig为我们提供了这种 功能，具体实现方法有以下几种。(1)建立JsonConfig实例，并配置属性排除列表,(2)用属性过滤器,(3)写一个自定义的 JsonBeanProcessor.</p>
<h3 id="1-实现JSONString接口的方法"><a href="#1-实现JSONString接口的方法" class="headerlink" title="1. 实现JSONString接口的方法"></a>1. 实现JSONString接口的方法</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">public class Person implements JSONString &#123;  </div><div class="line">private String name;  </div><div class="line">private String lastname;  </div><div class="line">private Address address;  </div><div class="line"></div><div class="line">// getters &amp; setters  </div><div class="line"></div><div class="line">public String toJSONString() &#123;</div><div class="line">return &quot;&#123;name:&apos;&quot;+name+&quot;&apos;,lastname:&apos;&quot;+lastname+&quot;&apos;&#125;&quot;;</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="2-第二种方法通过jsonconfig实例，对包含和需要排除的属性进行方便的添加或删除"><a href="#2-第二种方法通过jsonconfig实例，对包含和需要排除的属性进行方便的添加或删除" class="headerlink" title="2.第二种方法通过jsonconfig实例，对包含和需要排除的属性进行方便的添加或删除"></a>2.第二种方法通过jsonconfig实例，对包含和需要排除的属性进行方便的添加或删除</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">public class Person &#123;  </div><div class="line">    private String name;  </div><div class="line">    private String lastname;  </div><div class="line">    private Address address;  </div><div class="line">    // getters &amp; setters // </div><div class="line">&#125;  </div><div class="line"></div><div class="line">JsonConfig jsonConfig = new JsonConfig();  </div><div class="line">jsonConfig.setExclusions( new String[]&#123;&quot;address&quot;&#125;);  </div><div class="line">Person bean = new Person(&quot;jack&quot;,&quot;li&quot;);  </div><div class="line">JSON json = JSONSerializer.toJSON(bean, jsonConfig);</div></pre></td></tr></table></figure>
<h3 id="3-使用propertyFilter可以允许同时对需要排除的属性和类进行控制，这种控制还可以是双向的，也可以应用到json字符串到java对象"><a href="#3-使用propertyFilter可以允许同时对需要排除的属性和类进行控制，这种控制还可以是双向的，也可以应用到json字符串到java对象" class="headerlink" title="3. 使用propertyFilter可以允许同时对需要排除的属性和类进行控制，这种控制还可以是双向的，也可以应用到json字符串到java对象"></a>3. 使用propertyFilter可以允许同时对需要排除的属性和类进行控制，这种控制还可以是双向的，也可以应用到json字符串到java对象</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">public class Person &#123;  </div><div class="line">private String name;  </div><div class="line">private String lastname;  </div><div class="line">private Address address;  </div><div class="line"></div><div class="line">// getters &amp; setters  </div><div class="line">&#125;  </div><div class="line"></div><div class="line">JsonConfig jsonConfig = new JsonConfig();  </div><div class="line">jsonConfig.setJsonPropertyFilter( new PropertyFilter()&#123;  </div><div class="line"></div><div class="line">public boolean apply(Object source/* 属性的拥有者 */ , String name /*属性名字*/ , Object value/* 属性值 */ )&#123;  </div><div class="line">// return true to skip name  </div><div class="line">return source instanceof Person &amp;&amp; name.equals(&quot;address&quot;);  </div><div class="line">&#125;  </div><div class="line">&#125;);  </div><div class="line">Person bean = new Person(&quot;jack&quot;,&quot;li&quot;); </div><div class="line">JSON json = JSONSerializer.toJSON( bean, jsonConfig )</div></pre></td></tr></table></figure>
<h3 id="4-最后来看JsonBeanProcessor-这种方式和实现JsonString很类似，返回一个代表原来的domain类的合法JSONObject"><a href="#4-最后来看JsonBeanProcessor-这种方式和实现JsonString很类似，返回一个代表原来的domain类的合法JSONObject" class="headerlink" title="4. 最后来看JsonBeanProcessor,这种方式和实现JsonString很类似，返回一个代表原来的domain类的合法JSONObject"></a>4. 最后来看JsonBeanProcessor,这种方式和实现JsonString很类似，返回一个代表原来的domain类的合法JSONObject</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">public class Person &#123;  </div><div class="line">private String name;  </div><div class="line">private String lastname;  </div><div class="line">private Address address;  </div><div class="line"></div><div class="line">// getters &amp; setters  </div><div class="line">&#125;  </div><div class="line"></div><div class="line">JsonConfig jsonConfig = new JsonConfig();  </div><div class="line">jsonConfig.registerJsonBeanProcessor( Person.class, new JsonBeanProcessor()&#123;  </div><div class="line"></div><div class="line">public JSONObject processBean( Object bean, JsonConfig jsonConfig )&#123;  </div><div class="line">if(!(bean instanceof Person))&#123;  </div><div class="line">return new JSONObject(true);  </div><div class="line">&#125;  </div><div class="line">Person person = (Person) bean;  </div><div class="line">return new JSONObject() .element( &quot;name&quot;, person.getName()) .element( &quot;lastname&quot;, person.getLastname());  </div><div class="line">&#125;  </div><div class="line">&#125;);  </div><div class="line"></div><div class="line">Person bean = new Person(&quot;jack&quot;,&quot;li&quot;); </div><div class="line">JSON json = JSONSerializer.toJSON( bean, jsonConfig );</div></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/07/26/centos-install-mysql/" itemprop="url">
                  Centos6.4 用rpm方式安装MySql5.6
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-07-26T17:24:35+08:00" content="2015 年 07 月 26 日">
              2015 年 07 月 26 日
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/服务器/" itemprop="url" rel="index">
                    <span itemprop="name">服务器</span>
                  </a>
                </span>

                
                
                  ， 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/服务器/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/07/26/centos-install-mysql/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2015/07/26/centos-install-mysql/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2015/07/26/centos-install-mysql/" class="leancloud_visitors" data-flag-title="Centos6.4 用rpm方式安装MySql5.6">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>转载请注明出处，谢谢！（原文链接：<a href="https://chensian.github.io/2015/07/26/centos-install-mysql/" target="_blank" rel="external">https://chensian.github.io/2015/07/26/centos-install-mysql/</a> ）</p>
<h1 id="Centos6-4-用rpm方式安装MySql5-6"><a href="#Centos6-4-用rpm方式安装MySql5-6" class="headerlink" title="Centos6.4 用rpm方式安装MySql5.6"></a>Centos6.4 用rpm方式安装MySql5.6</h1><h3 id="1-查看系统是否安装了MySQL"><a href="#1-查看系统是否安装了MySQL" class="headerlink" title="1. 查看系统是否安装了MySQL"></a>1. 查看系统是否安装了MySQL</h3><p>使用命令：</p>
<pre><code>#rpm -qa | grep mysql 
</code></pre><h3 id="2-卸载已安装的MySQL"><a href="#2-卸载已安装的MySQL" class="headerlink" title="2. 卸载已安装的MySQL"></a>2. 卸载已安装的MySQL</h3><p>卸载mysql命令如下： </p>
<pre><code>#rpm -e --nodeps  mysql-libs-5.1.61-4.el6.x86_64
</code></pre><p>要将 /var/lib/mysql文件夹下的所有文件都删除干净</p>
<h3 id="3-安装新的MySQL"><a href="#3-安装新的MySQL" class="headerlink" title="3. 安装新的MySQL"></a>3. 安装新的MySQL</h3><p>命令如下：</p>
<pre><code>#rpm -ivh MySQL-server-5.5.30-1.el6.x86_64.rpm

#rpm -ivh MySQL-client-5.5.30-1.el6.x86_64.rpm

#rpm -ivh MySQL-devel-5.5.30-1.el6.x86_64.rpm
</code></pre><h3 id="4-启动MySQL服务"><a href="#4-启动MySQL服务" class="headerlink" title="4. 启动MySQL服务"></a>4. 启动MySQL服务</h3><p>方法一：重新启动系统</p>
<p>方法二：#service mysql start</p>
<pre><code>查看MySQL运行状态的方法：


 使用命令：# /etc/rc.d/init.d/mysql status
 结果：   显示 “SUCCESS” 则已经运行
              显示 “FAILED”  则没有运行
</code></pre><h3 id="5-MySQL服务一些其他命令"><a href="#5-MySQL服务一些其他命令" class="headerlink" title="5. MySQL服务一些其他命令"></a>5. MySQL服务一些其他命令</h3><pre><code>a、察看mysql是否在自动启动列表：  #　/sbin/chkconfig –list
b、添加mysql到系统自启动服务组：  #　/sbin/chkconfig　– add　mysql
c、把mysql从启动服务组中删除：    #　/sbin/chkconfig　– del　mysql  
d、停止mysql服务：                #  service mysql stop
e、脚本启动mysql服务：            #  /etc/rc.d/init.d/mysqld start  
f、脚本停止mysql服务：            #  /etc/rc.d/init.d/mysqld stop
</code></pre><h3 id="6、安装完成之后为MySQL设置root密码。"><a href="#6、安装完成之后为MySQL设置root密码。" class="headerlink" title="6、安装完成之后为MySQL设置root密码。"></a>6、安装完成之后为MySQL设置root密码。</h3><p>命令如下：</p>
<pre><code># mysql -u root -p
</code></pre><p>会提示输入密码，初始root密码保存在’/root/.mysql_secret’文件中<br>接着输入</p>
<pre><code>mysql&gt;SET PASSWORD = PASSWORD(&apos;123456&apos;);
</code></pre><h3 id="7、mysql安装目录说明"><a href="#7、mysql安装目录说明" class="headerlink" title="7、mysql安装目录说明"></a>7、mysql安装目录说明</h3><pre><code>/var/lib/mysql          数据库文件
/usr/share/mysql        命令及配置文件
/usr/bin                (mysqladmin、mysqldump等命令)
</code></pre><h3 id="8、linux-下安装的mysql表名是区分大小写的，如果要不区分大小写，可以采用以下方式"><a href="#8、linux-下安装的mysql表名是区分大小写的，如果要不区分大小写，可以采用以下方式" class="headerlink" title="8、linux 下安装的mysql表名是区分大小写的，如果要不区分大小写，可以采用以下方式"></a>8、linux 下安装的mysql表名是区分大小写的，如果要不区分大小写，可以采用以下方式</h3><p>   1、拷贝 /usr/share/mysql/my-huge.cnf到/etc/my.cnf（如果已有该文件可以直接修改）</p>
<pre><code>    命令如下：

# cp /usr/share/mysql/my-huge.cnf  /etc/my.cnf
</code></pre><p>   2、修改my.cnf 文件<br>        在 [mysqld]下增加<br>        lower_case_table_names=1 #表名全部为小写，避免出现大小写敏感</p>
<p>   3、重启mysql</p>
<pre><code># service mysql restart
</code></pre><h3 id="9-可选-、为连接MySQL的主机分配权限："><a href="#9-可选-、为连接MySQL的主机分配权限：" class="headerlink" title="9(可选)、为连接MySQL的主机分配权限："></a>9(可选)、为连接MySQL的主机分配权限：</h3><p>   命令如下：</p>
<pre><code>&gt;mysql GRANT SELECT,INSERT,UPDATE,DELETE ON *.* TO root@xxx.xxx.x.xxidentified by &apos;123456&apos;; //xxx.xxx.x.xx是你的IP
</code></pre><h3 id="10、开机启动MySQL"><a href="#10、开机启动MySQL" class="headerlink" title="10、开机启动MySQL"></a>10、开机启动MySQL</h3><p>用root用户登录终端</p>
<p>查看是否已经有MySQL的服务</p>
<pre><code># chkconfig --list
</code></pre><p>如果没有MySQL(如果有请忽略这个步骤)</p>
<pre><code># chkconfig --add mysql
</code></pre><p>设置开机启动mysql服务</p>
<pre><code># chkconfig mysql on
</code></pre><h3 id="11-可选-、更改MySQL默认字符集-默认字符集和操作系统字符集一样，所以不需要设置"><a href="#11-可选-、更改MySQL默认字符集-默认字符集和操作系统字符集一样，所以不需要设置" class="headerlink" title="11(可选)、更改MySQL默认字符集 (默认字符集和操作系统字符集一样，所以不需要设置)"></a>11(可选)、更改MySQL默认字符集 (默认字符集和操作系统字符集一样，所以不需要设置)</h3><p>查看mysql字符集：</p>
<pre><code>mysql&gt; show variables like &apos;character_set_%&apos;;
</code></pre>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/03/12/maven-eclipse/" itemprop="url">
                  maven 不能设置为web3.0人解决方法
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-03-12T21:51:50+08:00" content="2015 年 03 月 12 日">
              2015 年 03 月 12 日
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/开发工具/" itemprop="url" rel="index">
                    <span itemprop="name">开发工具</span>
                  </a>
                </span>

                
                
                  ， 
                

              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/开发工具/Eclipse/" itemprop="url" rel="index">
                    <span itemprop="name">Eclipse</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/03/12/maven-eclipse/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2015/03/12/maven-eclipse/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2015/03/12/maven-eclipse/" class="leancloud_visitors" data-flag-title="maven 不能设置为web3.0人解决方法">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>错误： Description Resource Path Location Type Cannot change version of project facet Dynamic Web Module to 3.0.</p>
<p>以下是在GG搜索到的。<a href="http://stackoverflow.com/questions/75786/eclipse-how-can-i-change-a-project-facet-from-tomcat-6-to-tomcat-5-5" target="_blank" rel="external">http://stackoverflow.com/questions/75786/eclipse-how-can-i-change-a-project-facet-from-tomcat-6-to-tomcat-5-5</a></p>
<p>首先在硬盘下找到\项目名\setting\文件夹下的org.eclipse.wst.common.project.facet.core.xml  xml文件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</div><div class="line">&lt;faceted-project&gt;</div><div class="line">  &lt;fixed facet=&quot;wst.jsdt.web&quot;/&gt;</div><div class="line">  &lt;installed facet=&quot;jst.web&quot; version=&quot;2.3&quot;/&gt;</div><div class="line">  &lt;installed facet=&quot;wst.jsdt.web&quot; version=&quot;1.0&quot;/&gt;</div><div class="line">  &lt;installed facet=&quot;java&quot; version=&quot;1.7&quot;/&gt;</div><div class="line">&lt;/faceted-project&gt;</div></pre></td></tr></table></figure>
<p>将jst.web，的version改成3.0.<br>然后在eclipse里右键该工程–maven–updateProject即可。。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/01/02/hello-world/" itemprop="url">
                  Hello World
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-01-02T11:51:50+08:00" content="2015 年 01 月 02 日">
              2015 年 01 月 02 日
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/01/02/hello-world/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2015/01/02/hello-world/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2015/01/02/hello-world/" class="leancloud_visitors" data-flag-title="Hello World">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Welcome to <a href="https://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo new <span class="string">"My New Post"</span></div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo server</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo generate</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo deploy</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/taylor.png"
               alt="陈世强" />
          <p class="site-author-name" itemprop="name">陈世强</p>
          <p class="site-description motion-element" itemprop="description">你陪着我的时候，我从没有羡慕任何人。</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">26</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">27</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">30</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/chensian" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://blog.csdn.net/chen_shiqiang" target="_blank" title="CSDN">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  CSDN
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.zhihu.com/people/chesian" target="_blank" title="知乎">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  知乎
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              Links
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://macshuo.com/" title="MacTalk" target="_blank">MacTalk</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://example.com/" title="Title" target="_blank">Title</a>
                </li>
              
            </ul>
          </div>
        

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2015 - 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">陈世强</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.0.1"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"chesian"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
  





  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
       search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body").append('<div class="popoverlay">').css('overflow', 'hidden');
      $('.popup').toggle();

    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
    'use strict';
    $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
            // get the contents from search data
            isfetched = true;
            $('.popup').detach().appendTo('.header-inner');
            var datas = $( "entry", xmlResponse ).map(function() {
                return {
                    title: $( "title", this ).text(),
                    content: $("content",this).text(),
                    url: $( "url" , this).text()
                };
            }).get();
            var $input = document.getElementById(search_id);
            var $resultContent = document.getElementById(content_id);
            $input.addEventListener('input', function(){
                var matchcounts = 0;
                var str='<ul class=\"search-result-list\">';                
                var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                $resultContent.innerHTML = "";
                if (this.value.trim().length > 1) {
                // perform local searching
                datas.forEach(function(data) {
                    var isMatch = true;
                    var content_index = [];
                    var data_title = data.title.trim().toLowerCase();
                    var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                    var data_url = data.url;
                    var index_title = -1;
                    var index_content = -1;
                    var first_occur = -1;
                    // only match artiles with not empty titles and contents
                    if(data_title != '' && data_content != '') {
                        keywords.forEach(function(keyword, i) {
                            index_title = data_title.indexOf(keyword);
                            index_content = data_content.indexOf(keyword);
                            if( index_title < 0 && index_content < 0 ){
                                isMatch = false;
                            } else {
                                if (index_content < 0) {
                                    index_content = 0;
                                }
                                if (i == 0) {
                                    first_occur = index_content;
                                }
                            }
                        });
                    }
                    // show search results
                    if (isMatch) {
                        matchcounts += 1;
                        str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                        var content = data.content.trim().replace(/<[^>]+>/g,"");
                        if (first_occur >= 0) {
                            // cut out 100 characters
                            var start = first_occur - 20;
                            var end = first_occur + 80;
                            if(start < 0){
                                start = 0;
                            }
                            if(start == 0){
                                end = 50;
                            }
                            if(end > content.length){
                                end = content.length;
                            }
                            var match_content = content.substring(start, end);
                            // highlight all keywords
                            keywords.forEach(function(keyword){
                                var regS = new RegExp(keyword, "gi");
                                match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                            });
                            
                            str += "<p class=\"search-result\">" + match_content +"...</p>"
                        }
                        str += "</li>";
                    }
                })};
                str += "</ul>";
                if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
                if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
                $resultContent.innerHTML = str;
            });
            proceedsearch();
        }
    });}

    // handle and trigger popup window;
    $('.popup-trigger').mousedown(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };

    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".popoverlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>

  

  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("Gp631ljrulxxQsO3C8Cf53fk-gzGzoHsz", "Uo1Jv7vhPGFYFrDjc73yHa7P");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

</body>
</html>
